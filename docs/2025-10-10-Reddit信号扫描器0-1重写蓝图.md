# Reddit Signal Scanner - 0-1é‡å†™è“å›¾

> **åˆ›å»ºæ—¥æœŸ**: 2025-10-10
> **ç›®æ ‡**: åŸºäºå®Œæ•´PRDæ–‡æ¡£ä½“ç³»ï¼Œä»é›¶é‡å»ºReddit Signal Scanner
> **å·¥æœŸ**: 15å¤©
> **è´¨é‡æ‰¿è¯º**: 100% PRDç¬¦åˆåº¦ + Linusè®¾è®¡å“²å­¦ + ç±»å‹å®‰å…¨é›¶å®¹å¿

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

### é‡å†™åŸå› 

**å½“å‰é¡¹ç›®é—®é¢˜**ï¼ˆåŸºäº2025-10-08æ·±åº¦æ ¸æŸ¥æŠ¥å‘Šï¼‰ï¼š
1. âŒ æ•°æ®æµè½¬å­—æ®µä¸åŒ¹é…ï¼ˆsignals vs insightsï¼‰å¯¼è‡´æŠ¥å‘Šæ°¸è¿œæ˜¾ç¤ºdemoæ•°æ®
2. âŒ æ•°æ®æ”¶é›†é‡ä¸è¶³ï¼ˆtotal_posts=1ï¼‰
3. âš ï¸ APIç«¯ç‚¹è†¨èƒ€ï¼ˆ59ä¸ª vs PRDå®šä¹‰çš„4ä¸ªæ ¸å¿ƒï¼‰
4. âš ï¸ é…ç½®ç®¡ç†æ··ä¹±ï¼ˆ3ä¸ª.env + 7ä¸ªYAMLåˆ†æ•£ï¼‰
5. âš ï¸ ä»£ç è¿‡å¤§ï¼ˆanalysis_tasks.py 1329è¡Œï¼‰
6. âœ… ç®—æ³•å®Œæ•´å®ç°ï¼ˆä½†æ•°æ®ç®¡é“æ•…éšœï¼‰

**é‡å†™ä¼˜åŠ¿**ï¼š
- âœ… ä»PRDæ–‡æ¡£ç›´æ¥å®ç°ï¼Œé¿å…å†å²å€ºåŠ¡
- âœ… ç±»å‹å®‰å…¨ä»ç¬¬ä¸€å¤©å†…å»ºï¼ˆ100% mypy --strictï¼‰
- âœ… æ¶æ„æ¸…æ™°ç®€æ´ï¼ˆä¸¥æ ¼éµå¾ª4è¡¨/4ç«¯ç‚¹/4æ­¥è®¾è®¡ï¼‰
- âœ… 15å¤©äº¤ä»˜å¯ç”¨MVP

---

## ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™

### Linus Torvaldsè®¾è®¡å“²å­¦

1. **æ•°æ®ç»“æ„ä¼˜å…ˆ**
   - å…ˆè®¾è®¡4è¡¨æ¶æ„ï¼Œä»£ç è‡ªç„¶ç®€å•
   - Users â†’ Tasks â†’ Analyses â†’ Reportsï¼ˆ1:N:1:1ï¼‰
   - æ¶ˆé™¤å¤æ‚çš„JOINå’Œç‰¹æ®Šæƒ…å†µ

2. **ç®€å•èƒœè¿‡èªæ˜**
   - 4ä¸ªAPIç«¯ç‚¹ vs 59ä¸ªè·¯ç”±
   - SSEå®æ—¶æ¨é€ vs 300æ¬¡è½®è¯¢
   - çº¿æ€§æµæ°´çº¿ vs å¤æ‚ä¾èµ–å›¾

3. **è¯šå®çš„æ¶æ„**
   - "5åˆ†é’Ÿæ‰¿è¯º"åŸºäºç¼“å­˜ï¼Œä¸æ˜¯é­”æ³•
   - æ˜ç¡®æ ‡æ³¨æ•°æ®æºï¼ˆ90%ç¼“å­˜ + 10% APIï¼‰
   - å®Œæ•´çš„é”™è¯¯æ¢å¤ç­–ç•¥

### ç±»å‹å®‰å…¨é›¶å®¹å¿

```python
# âŒ ç»å¯¹ç¦æ­¢
# type: ignore
Any
Dict[str, Any]
def func(data):  # æ— ç±»å‹æ³¨è§£

# âœ… å¿…é¡»éµå®ˆ
from typing import Dict, List, Optional
from pydantic import BaseModel

class TaskRequest(BaseModel):
    product_description: str

def analyze(request: TaskRequest) -> Dict[str, str]:
    return {"task_id": "..."}
```

---

## ğŸ“‚ ç›®æ ‡æ¶æ„ï¼ˆPRDé©±åŠ¨ï¼‰

### æ•°æ®å±‚ï¼ˆPRD-01ï¼‰

```sql
-- å››è¡¨æ¶æ„ï¼šæ¶ˆé™¤ç‰¹æ®Šæƒ…å†µ
users (id, email, password_hash, created_at)
  â†“ 1:N
tasks (id, user_id, product_description, status)
  â†“ 1:1
analyses (id, task_id, insights JSONB, sources JSONB)
  â†“ 1:1
reports (id, analysis_id, html_content)

-- ç‹¬ç«‹ç¼“å­˜ç®¡ç†
community_cache (community_name, last_crawled_at, posts_cached)
```

**å…³é”®å†³ç­–**ï¼š
- ä»ç¬¬ä¸€å¤©æ”¯æŒå¤šç§Ÿæˆ·ï¼ˆuser_idä¸æ˜¯é¢„ç•™å­—æ®µï¼‰
- JSONB + SchemaéªŒè¯ï¼ˆé˜²æ­¢æ•°æ®æ ¼å¼é”™è¯¯ï¼‰
- ç¼“å­˜ä¼˜å…ˆæ¶æ„æ”¯æŒ

### APIå±‚ï¼ˆPRD-02ï¼‰

```
POST /api/analyze                    # åˆ›å»ºä»»åŠ¡ (< 200ms)
GET /api/analyze/stream/{task_id}    # SSEå®æ—¶æ¨é€ï¼ˆä¸»è¦ï¼‰
GET /api/status/{task_id}            # è½®è¯¢fallback
GET /api/report/{task_id}            # è·å–æŠ¥å‘Š
```

**å…³é”®å†³ç­–**ï¼š
- SSEä¼˜å…ˆï¼Œè½®è¯¢ä½œä¸ºé™çº§
- å®Œæ•´é”™è¯¯æ¢å¤æœºåˆ¶ï¼ˆæ£€æµ‹â†’æ¢å¤â†’é™çº§ï¼‰
- JWTè®¤è¯ + å¤šç§Ÿæˆ·éš”ç¦»

### åˆ†æå¼•æ“ï¼ˆPRD-03ï¼‰

```
Step 1: æ™ºèƒ½ç¤¾åŒºå‘ç° (30ç§’)
  â†“ TF-IDF + è¯­ä¹‰ç›¸ä¼¼åº¦ â†’ Top 20ç¤¾åŒº
Step 2: å¹¶è¡Œæ•°æ®é‡‡é›† (120ç§’)
  â†“ 90%ç¼“å­˜ + 10%å®æ—¶API
Step 3: ç»Ÿä¸€ä¿¡å·æå– (90ç§’)
  â†“ Redditç‰¹å®šNLP â†’ ç—›ç‚¹/ç«å“/æœºä¼š
Step 4: æ™ºèƒ½æ’åºè¾“å‡º (30ç§’)
  â†“ å¤šç»´åº¦è¯„åˆ† â†’ ç»“æ„åŒ–æŠ¥å‘Š
```

**å…³é”®å†³ç­–**ï¼š
- ç¼“å­˜ä¼˜å…ˆä¿è¯"5åˆ†é’Ÿæ‰¿è¯º"
- Redditä¸“ç”¨NLPæ¨¡å‹ï¼ˆéTwitteræ¨¡å‹ï¼‰
- åŠ¨æ€ç¤¾åŒºæ•°é‡ï¼ˆ10-30ä¸ªï¼ŒåŸºäºç¼“å­˜å‘½ä¸­ç‡ï¼‰

### ä»»åŠ¡ç³»ç»Ÿï¼ˆPRD-04ï¼‰

```
FastAPI (HTTP) â†’ Celery (ä»»åŠ¡é˜Ÿåˆ—) â†’ Redis (çŠ¶æ€ç¼“å­˜)
                     â†“
            Analysis Workers (å¹¶è¡Œå¤„ç†)
                     â†“
            PostgreSQL (ç»“æœæŒä¹…åŒ–)
```

**å…³é”®å†³ç­–**ï¼š
- Celeryè§£è€¦HTTPå’Œåˆ†æå¼•æ“
- 3æ¬¡é‡è¯• + æ­»ä¿¡é˜Ÿåˆ—
- å¯ä¸­æ–­è¶…æ—¶æœºåˆ¶

---

## ğŸ“… 15å¤©æ‰§è¡Œè·¯çº¿å›¾

### Phase 0: ç¯å¢ƒå‡†å¤‡ (Day 0)

**ç›®æ ‡**: å¹²å‡€çš„å¼€å‘ç¯å¢ƒ + å·¥å…·é“¾

```bash
# 1. åˆ›å»ºå…¨æ–°ä»“åº“
mkdir RedditSignalScanner && cd RedditSignalScanner
git init

# 2. Pythonç¯å¢ƒï¼ˆ3.11ï¼‰
python3.11 -m venv venv
source venv/bin/activate

# 3. å®‰è£…æ ¸å¿ƒä¾èµ–
pip install fastapi[all]==0.104.1 \
            sqlalchemy==2.0.23 \
            alembic==1.12.0 \
            pydantic==2.5.0 \
            celery==5.3.4 \
            redis==5.0.1

# 4. ç±»å‹æ£€æŸ¥å·¥å…·
pip install mypy==1.7.0

# 5. æµ‹è¯•å·¥å…·
pip install pytest==7.4.0 pytest-asyncio pytest-cov

# 6. é…ç½®mypy (100% strict)
cat > mypy.ini << EOF
[mypy]
python_version = 3.11
strict = True
warn_return_any = True
warn_unused_configs = True
disallow_untyped_defs = True
disallow_any_unimported = True
EOF

# 7. å‰ç«¯ç¯å¢ƒï¼ˆNode 18ï¼‰
npx create-vite@latest frontend -- --template react-ts
cd frontend && npm install
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] `python --version` æ˜¾ç¤º 3.11.x
- [ ] `mypy --version` å¯ç”¨
- [ ] `pytest --version` å¯ç”¨
- [ ] `npm --version` å¯ç”¨

---

### Phase 1: æ•°æ®æ¨¡å‹å±‚ (Day 1-2)

**ç›®æ ‡**: å®Œæ•´çš„4è¡¨æ¶æ„ + è¿ç§»è„šæœ¬

#### Day 1: è¡¨ç»“æ„è®¾è®¡

**æ–‡ä»¶**: `backend/app/models/__init__.py`

```python
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, String, UUID, Text, TIMESTAMP, Enum, Numeric
from sqlalchemy.dialects.postgresql import JSONB
from sqlalchemy.sql import func
import enum
from typing import Optional

Base = declarative_base()

class TaskStatus(enum.Enum):
    PENDING = "pending"
    PROCESSING = "processing"
    COMPLETED = "completed"
    FAILED = "failed"

class User(Base):
    __tablename__ = "users"

    id = Column(UUID(as_uuid=True), primary_key=True, server_default=func.gen_random_uuid())
    email = Column(String(255), unique=True, nullable=False)
    password_hash = Column(String(255), nullable=False)
    created_at = Column(TIMESTAMP(timezone=True), server_default=func.now())
    is_active = Column(Boolean, default=True)

class Task(Base):
    __tablename__ = "tasks"

    id = Column(UUID(as_uuid=True), primary_key=True, server_default=func.gen_random_uuid())
    user_id = Column(UUID(as_uuid=True), ForeignKey("users.id", ondelete="CASCADE"), nullable=False)
    product_description = Column(Text, nullable=False)
    status = Column(Enum(TaskStatus), nullable=False, default=TaskStatus.PENDING)
    created_at = Column(TIMESTAMP(timezone=True), server_default=func.now())
    completed_at = Column(TIMESTAMP(timezone=True), nullable=True)

class Analysis(Base):
    __tablename__ = "analyses"

    id = Column(UUID(as_uuid=True), primary_key=True, server_default=func.gen_random_uuid())
    task_id = Column(UUID(as_uuid=True), ForeignKey("tasks.id", ondelete="CASCADE"), nullable=False, unique=True)
    insights = Column(JSONB, nullable=False)  # SchemaéªŒè¯åœ¨åº”ç”¨å±‚
    sources = Column(JSONB, nullable=False)
    confidence_score = Column(Numeric(3,2), nullable=False)
    created_at = Column(TIMESTAMP(timezone=True), server_default=func.now())

class CommunityCache(Base):
    __tablename__ = "community_cache"

    community_name = Column(String(100), primary_key=True)
    last_crawled_at = Column(TIMESTAMP(timezone=True), nullable=False)
    posts_cached = Column(Integer, default=0)
    quality_score = Column(Numeric(3,2), default=0.50)
    hit_count = Column(Integer, default=0)
```

**Pydantic SchemaéªŒè¯** (`backend/app/schemas/analysis.py`):

```python
from pydantic import BaseModel, Field, validator
from typing import List
from decimal import Decimal

class PainPoint(BaseModel):
    description: str = Field(min_length=10, max_length=500)
    frequency: int = Field(ge=1)
    sentiment_score: Decimal = Field(ge=-1.0, le=1.0)

class Competitor(BaseModel):
    name: str = Field(min_length=1, max_length=100)
    mentions: int = Field(ge=1)
    sentiment: str

class Opportunity(BaseModel):
    description: str = Field(min_length=10, max_length=500)
    relevance_score: Decimal = Field(ge=0.0, le=1.0)

class Insights(BaseModel):
    pain_points: List[PainPoint]
    competitors: List[Competitor]
    opportunities: List[Opportunity]

    @validator('pain_points')
    def validate_pain_points(cls, v: List[PainPoint]) -> List[PainPoint]:
        if len(v) == 0:
            raise ValueError("è‡³å°‘éœ€è¦1ä¸ªç—›ç‚¹")
        return v

class AnalysisCreate(BaseModel):
    task_id: str
    insights: Insights
    confidence_score: Decimal = Field(ge=0.0, le=1.0)
```

#### Day 2: æ•°æ®åº“è¿ç§»

**Alembicé…ç½®** (`backend/alembic/versions/001_initial_schema.py`):

```python
"""Initial schema

Revision ID: 001
Create Date: 2025-10-10
"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

def upgrade() -> None:
    # åˆ›å»ºæšä¸¾
    op.execute("CREATE TYPE task_status AS ENUM ('pending', 'processing', 'completed', 'failed')")

    # åˆ›å»ºusersè¡¨
    op.create_table(
        'users',
        sa.Column('id', postgresql.UUID(as_uuid=True), primary_key=True, server_default=sa.text('gen_random_uuid()')),
        sa.Column('email', sa.String(255), unique=True, nullable=False),
        sa.Column('password_hash', sa.String(255), nullable=False),
        sa.Column('created_at', sa.TIMESTAMP(timezone=True), server_default=sa.text('now()')),
        sa.Column('is_active', sa.Boolean(), default=True)
    )

    # åˆ›å»ºç´¢å¼•
    op.create_index('idx_users_email', 'users', ['email'])

    # ... å…¶ä»–è¡¨åˆ›å»ºï¼ˆtasks, analyses, community_cacheï¼‰

def downgrade() -> None:
    op.drop_table('community_cache')
    op.drop_table('analyses')
    op.drop_table('tasks')
    op.drop_table('users')
    op.execute("DROP TYPE task_status")
```

**æµ‹è¯•** (`backend/tests/test_models.py`):

```python
import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from backend.app.models import Base, User, Task, TaskStatus

@pytest.fixture
def db_session():
    engine = create_engine("postgresql://test:test@localhost:5432/test_db")
    Base.metadata.create_all(engine)
    Session = sessionmaker(bind=engine)
    session = Session()
    yield session
    session.close()
    Base.metadata.drop_all(engine)

def test_create_user(db_session):
    user = User(email="test@example.com", password_hash="hashed")
    db_session.add(user)
    db_session.commit()

    assert user.id is not None
    assert user.email == "test@example.com"

def test_user_task_relationship(db_session):
    user = User(email="test@example.com", password_hash="hashed")
    db_session.add(user)
    db_session.commit()

    task = Task(user_id=user.id, product_description="Test product")
    db_session.add(task)
    db_session.commit()

    assert task.status == TaskStatus.PENDING
    assert task.user_id == user.id
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] `alembic upgrade head` æˆåŠŸæ‰§è¡Œ
- [ ] 4ä¸ªè¡¨å…¨éƒ¨åˆ›å»º
- [ ] ç´¢å¼•å…¨éƒ¨ç”Ÿæˆ
- [ ] `pytest backend/tests/test_models.py` å…¨éƒ¨é€šè¿‡
- [ ] `mypy backend/app/models` 0é”™è¯¯

---

### Phase 2: APIå±‚ (Day 3-5)

**ç›®æ ‡**: 4ä¸ªæ ¸å¿ƒç«¯ç‚¹ + SSEæ¨é€

#### Day 3: ä»»åŠ¡åˆ›å»ºAPI

**æ–‡ä»¶**: `backend/app/api/v1/endpoints/analyze.py`

```python
from fastapi import APIRouter, Depends, HTTPException, status
from sqlalchemy.ext.asyncio import AsyncSession
from pydantic import BaseModel, Field
from typing import Dict
from uuid import UUID
import logging

router = APIRouter()
logger = logging.getLogger(__name__)

class AnalyzeRequest(BaseModel):
    product_description: str = Field(min_length=10, max_length=2000)

class AnalyzeResponse(BaseModel):
    task_id: str
    status: str
    created_at: str
    estimated_completion: str
    sse_endpoint: str

@router.post("/analyze", response_model=AnalyzeResponse, status_code=status.HTTP_201_CREATED)
async def create_analysis_task(
    request: AnalyzeRequest,
    db: AsyncSession = Depends(get_db),
    current_user: User = Depends(get_current_user)
) -> AnalyzeResponse:
    """åˆ›å»ºåˆ†æä»»åŠ¡ - PRD-02è¦æ±‚<200mså“åº”"""
    try:
        # åˆ›å»ºä»»åŠ¡è®°å½•
        task = Task(
            user_id=current_user.id,
            product_description=request.product_description,
            status=TaskStatus.PENDING
        )
        db.add(task)
        await db.commit()
        await db.refresh(task)

        # å¼‚æ­¥è§¦å‘Celeryä»»åŠ¡
        from backend.app.tasks.analysis_tasks import analyze_product
        analyze_product.delay(str(task.id))

        return AnalyzeResponse(
            task_id=str(task.id),
            status="pending",
            created_at=task.created_at.isoformat(),
            estimated_completion=(task.created_at + timedelta(minutes=5)).isoformat(),
            sse_endpoint=f"/api/analyze/stream/{task.id}"
        )
    except Exception as e:
        logger.error(f"Failed to create task: {e}")
        raise HTTPException(status_code=500, detail="ä»»åŠ¡åˆ›å»ºå¤±è´¥")
```

#### Day 4: SSEå®æ—¶æ¨é€

**æ–‡ä»¶**: `backend/app/api/v1/endpoints/stream.py`

```python
from fastapi import APIRouter, Request
from fastapi.responses import StreamingResponse
import asyncio
import json
from typing import AsyncGenerator

router = APIRouter()

@router.get("/analyze/stream/{task_id}")
async def stream_progress(task_id: str, request: Request) -> StreamingResponse:
    """SSEå®æ—¶è¿›åº¦æ¨é€ - PRD-02æ ¸å¿ƒåŠŸèƒ½"""

    async def event_generator() -> AsyncGenerator[str, None]:
        try:
            # å‘é€è¿æ¥ç¡®è®¤
            yield f"data: {json.dumps({'event': 'connected', 'task_id': task_id})}\n\n"

            # ç›‘æ§ä»»åŠ¡è¿›åº¦
            while True:
                # æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æ–­å¼€
                if await request.is_disconnected():
                    break

                # ä»Redisè·å–ä»»åŠ¡çŠ¶æ€
                status = await get_task_status_from_redis(task_id)

                if status.status == "processing":
                    # å‘é€è¿›åº¦æ›´æ–°
                    event_data = {
                        "event": "progress",
                        "status": "processing",
                        "current_step": status.current_step,
                        "percentage": status.percentage
                    }
                    yield f"data: {json.dumps(event_data)}\n\n"

                elif status.status == "completed":
                    # å‘é€å®Œæˆäº‹ä»¶
                    yield f"event: completed\n"
                    yield f"data: {json.dumps({'event': 'completed', 'task_id': task_id})}\n\n"
                    break

                elif status.status == "failed":
                    # å‘é€é”™è¯¯äº‹ä»¶
                    yield f"event: error\n"
                    yield f"data: {json.dumps({'event': 'error', 'error': status.error})}\n\n"
                    break

                await asyncio.sleep(1)  # 1ç§’è½®è¯¢é—´éš”

        finally:
            yield f"event: close\n"
            yield f"data: {json.dumps({'event': 'connection_closed'})}\n\n"

    return StreamingResponse(
        event_generator(),
        media_type="text/event-stream",
        headers={
            "Cache-Control": "no-cache",
            "Connection": "keep-alive",
            "X-Accel-Buffering": "no"
        }
    )
```

#### Day 5: çŠ¶æ€æŸ¥è¯¢ + æŠ¥å‘Šè·å–

**æ–‡ä»¶**: `backend/app/api/v1/endpoints/status.py`

```python
@router.get("/status/{task_id}", response_model=TaskStatusResponse)
async def get_task_status(
    task_id: str,
    db: AsyncSession = Depends(get_db),
    current_user: User = Depends(get_current_user)
) -> TaskStatusResponse:
    """æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ - PRD-02 Fallbackè½®è¯¢"""
    task = await db.get(Task, UUID(task_id))

    if not task:
        raise HTTPException(status_code=404, detail="ä»»åŠ¡ä¸å­˜åœ¨")

    # å¤šç§Ÿæˆ·éš”ç¦»æ£€æŸ¥
    if task.user_id != current_user.id:
        raise HTTPException(status_code=403, detail="æ— æƒè®¿é—®")

    return TaskStatusResponse(
        task_id=str(task.id),
        status=task.status.value,
        created_at=task.created_at.isoformat(),
        completed_at=task.completed_at.isoformat() if task.completed_at else None
    )
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] POST /api/analyze å“åº”æ—¶é—´ < 200ms
- [ ] SSEè¿æ¥æˆåŠŸå»ºç«‹å¹¶æ¨é€äº‹ä»¶
- [ ] è½®è¯¢APIå“åº”æ—¶é—´ < 50ms
- [ ] å¤šç§Ÿæˆ·éš”ç¦»æµ‹è¯•é€šè¿‡
- [ ] `mypy backend/app/api` 0é”™è¯¯

---

### Phase 3: åˆ†æå¼•æ“ (Day 6-8)

**ç›®æ ‡**: 4æ­¥åˆ†ææµæ°´çº¿

**å‚è€ƒ**: å®Œæ•´å®ç°è§PRD-03ï¼Œè¿™é‡Œä»…å±•ç¤ºéª¨æ¶

```python
# backend/app/services/analysis_engine.py
from typing import List, Dict
from pydantic import BaseModel

class AnalysisEngine:
    """4æ­¥åˆ†ææµæ°´çº¿ - PRD-03"""

    async def analyze(self, product_description: str) -> Dict[str, Any]:
        # Step 1: æ™ºèƒ½ç¤¾åŒºå‘ç° (30ç§’)
        communities = await self.discover_communities(product_description)

        # Step 2: å¹¶è¡Œæ•°æ®é‡‡é›† (120ç§’) - ç¼“å­˜ä¼˜å…ˆ
        posts_data = await self.collect_data(communities)

        # Step 3: ç»Ÿä¸€ä¿¡å·æå– (90ç§’)
        signals = await self.extract_signals(posts_data)

        # Step 4: æ™ºèƒ½æ’åºè¾“å‡º (30ç§’)
        report = await self.generate_report(signals)

        return report
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ€»å¤„ç†æ—¶é—´ < 270ç§’ï¼ˆ5åˆ†é’Ÿä»¥å†…ï¼‰
- [ ] ç¼“å­˜å‘½ä¸­ç‡ > 60%
- [ ] ä¿¡å·æå–å‡†ç¡®ç‡ > 75%ï¼ˆäººå·¥æ ‡æ³¨éªŒè¯ï¼‰

---

### Phase 4: å‰ç«¯ç•Œé¢ (Day 9-11)

**ç›®æ ‡**: 3é¡µé¢React SPA

```typescript
// frontend/src/pages/InputPage.tsx
export function InputPage() {
  const [description, setDescription] = useState("");

  const handleSubmit = async () => {
    const response = await api.post("/api/analyze", {
      product_description: description
    });

    // å»ºç«‹SSEè¿æ¥
    const eventSource = new EventSource(
      `/api/analyze/stream/${response.data.task_id}`
    );

    eventSource.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if (data.event === "completed") {
        navigate(`/report/${response.data.task_id}`);
      }
    };
  };

  return <form onSubmit={handleSubmit}>...</form>;
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] SSEå®¢æˆ·ç«¯æ­£å¸¸å·¥ä½œ
- [ ] 3ä¸ªé¡µé¢è·¯ç”±æ­£ç¡®
- [ ] TypeScriptç¼–è¯‘0é”™è¯¯
- [ ] å‰ç«¯æµ‹è¯•è¦†ç›–ç‡ > 70%

---

### Phase 5: æµ‹è¯•ä¸éªŒæ”¶ (Day 12-15)

**ç›®æ ‡**: ç«¯åˆ°ç«¯æµ‹è¯• + æ€§èƒ½éªŒè¯

```python
# tests/integration/test_e2e_flow.py
@pytest.mark.integration
async def test_complete_analysis_flow():
    """ç«¯åˆ°ç«¯æµ‹è¯•ï¼šä»æäº¤åˆ°æŠ¥å‘Š"""
    # 1. åˆ›å»ºä»»åŠ¡
    response = await client.post("/api/analyze", json={
        "product_description": "AIç¬”è®°åº”ç”¨ï¼Œå¸®åŠ©ç ”ç©¶è€…ç®¡ç†çŸ¥è¯†"
    })
    assert response.status_code == 201
    task_id = response.json()["task_id"]

    # 2. ç­‰å¾…å®Œæˆï¼ˆæœ€å¤š5åˆ†é’Ÿï¼‰
    start_time = time.time()
    while time.time() - start_time < 300:
        status = await client.get(f"/api/status/{task_id}")
        if status.json()["status"] == "completed":
            break
        await asyncio.sleep(2)

    # 3. éªŒè¯æŠ¥å‘Š
    report = await client.get(f"/api/report/{task_id}")
    assert report.status_code == 200
    data = report.json()
    assert len(data["pain_points"]) > 0
    assert data["confidence_score"] > 0.7
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] E2Eæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•ç¬¦åˆPRDæŒ‡æ ‡
- [ ] mypy --strict 0é”™è¯¯
- [ ] pytestè¦†ç›–ç‡ > 80%

---

## ğŸ“Š è´¨é‡é—¨ç¦

### æ¯æ—¥æ£€æŸ¥æ¸…å•

```bash
# 1. ç±»å‹æ£€æŸ¥ï¼ˆå¿…é¡»0é”™è¯¯ï¼‰
mypy --strict backend/app backend/tests

# 2. æµ‹è¯•ï¼ˆå¿…é¡»å…¨éƒ¨é€šè¿‡ï¼‰
pytest backend/tests -v --cov=backend.app --cov-report=term-missing

# 3. ä»£ç æ ¼å¼
black backend/app --check
isort backend/app --check

# 4. å‰ç«¯ç±»å‹æ£€æŸ¥
cd frontend && npm run type-check

# 5. å‰ç«¯æµ‹è¯•
cd frontend && npm test
```

### æäº¤å‰æ£€æŸ¥

- [ ] mypy 0é”™è¯¯
- [ ] pytest å…¨éƒ¨é€šè¿‡
- [ ] è¦†ç›–ç‡ > 80%
- [ ] æ— console.logæ®‹ç•™
- [ ] æ–‡æ¡£æ›´æ–°

---

## ğŸ“š å…³é”®æ–‡æ¡£ç´¢å¼•

**å¿…è¯»PRD**ï¼ˆæŒ‰å®æ–½é¡ºåºï¼‰ï¼š
1. `docs/PRD/PRD-01-æ•°æ®æ¨¡å‹.md` - 4è¡¨æ¶æ„è®¾è®¡
2. `docs/PRD/PRD-02-APIè®¾è®¡.md` - 4ç«¯ç‚¹è§„èŒƒ
3. `docs/PRD/PRD-03-åˆ†æå¼•æ“.md` - 4æ­¥ç®—æ³•
4. `docs/PRD/PRD-04-ä»»åŠ¡ç³»ç»Ÿ.md` - Celeryé…ç½®
5. `docs/PRD/PRD-05-å‰ç«¯äº¤äº’.md` - React SPA
6. `docs/PRD/PRD-06-ç”¨æˆ·è®¤è¯.md` - JWTç³»ç»Ÿ
7. `docs/PRD/PRD-07-Adminåå°.md` - ç›‘æ§é¢æ¿
8. `docs/PRD/PRD-08-ç«¯åˆ°ç«¯æµ‹è¯•è§„èŒƒ.md` - æµ‹è¯•ç­–ç•¥

**å‚è€ƒæ–‡æ¡£**ï¼š
- `docs/PRD/ARCHITECTURE.md` - æ¶æ„è¾¹ç•Œ
- `docs/PRD/PRD-INDEX.md` - PRDä¾èµ–å…³ç³»
- `2025-10-09-æ•æ·å¼€å‘é¿å‘ä¸é«˜æ•ˆäº¤ä»˜æŒ‡å—.md` - å¼€å‘æµç¨‹

---

## âœ… æœ€ç»ˆäº¤ä»˜æ¸…å•

### ä»£ç äº¤ä»˜
- [ ] åç«¯ä»£ç ï¼ˆbackend/ï¼‰
- [ ] å‰ç«¯ä»£ç ï¼ˆfrontend/ï¼‰
- [ ] æ•°æ®åº“è¿ç§»ï¼ˆalembic/ï¼‰
- [ ] æµ‹è¯•ä»£ç ï¼ˆtests/ï¼‰
- [ ] é…ç½®æ–‡ä»¶ï¼ˆ.env.example, docker-compose.ymlï¼‰

### æ–‡æ¡£äº¤ä»˜
- [ ] README.mdï¼ˆå¿«é€Ÿå¼€å§‹ï¼‰
- [ ] APIæ–‡æ¡£ï¼ˆOpenAPI/Swaggerï¼‰
- [ ] éƒ¨ç½²æ–‡æ¡£
- [ ] ç»´æŠ¤æ‰‹å†Œ
- [ ] æ¶æ„å†³ç­–è®°å½•ï¼ˆADRï¼‰

### è´¨é‡æŠ¥å‘Š
- [ ] ç±»å‹æ£€æŸ¥æŠ¥å‘Šï¼ˆmypyï¼‰
- [ ] æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
- [ ] æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
- [ ] PRDç¬¦åˆåº¦æŠ¥å‘Š

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

1. **åŠŸèƒ½å®Œæ•´æ€§**: 8ä¸ªPRD 100%å®ç°
2. **ç±»å‹å®‰å…¨**: mypy --strict 0é”™è¯¯
3. **æµ‹è¯•è¦†ç›–**: åç«¯>80%, å‰ç«¯>70%
4. **æ€§èƒ½è¾¾æ ‡**: 5åˆ†é’Ÿåˆ†ææ‰¿è¯ºå…‘ç°
5. **ä»£ç è´¨é‡**: æ— type:ignore, æ— Anyç±»å‹
6. **æ–‡æ¡£åŒæ­¥**: ä»£ç ä¸PRD 100%å¯¹åº”

---

**ç¥å¼€å‘é¡ºåˆ©ï¼è®°ä½Linusçš„è¯ï¼š"Talk is cheap. Show me the code."**
