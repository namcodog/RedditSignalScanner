# Day 4 ä»»åŠ¡åˆ†é…ä¸éªŒæ”¶æ–‡æ¡£

> **æ—¥æœŸ**: 2025-10-10 (Day 4)
> **æ–‡æ¡£ç”¨é€”**: ä»»åŠ¡åˆ†é…ã€è¿›åº¦è·Ÿè¸ªã€éªŒæ”¶æ ‡å‡†
> **åˆ›å»ºæ—¶é—´**: 16:45
> **è´£ä»»äºº**: Lead

---

## ğŸ“… Day 4 æ€»ä½“ç›®æ ‡

### å…³é”®äº§å‡º
- âœ… **4ä¸ªæ ¸å¿ƒAPIç«¯ç‚¹å®Œæˆ**ï¼ˆPOST /analyze + GET /status + SSE stream + GET /reportï¼‰
- âœ… **ä»»åŠ¡ç³»ç»Ÿ100%å®Œæˆ**ï¼ˆä»»åŠ¡çŠ¶æ€ç®¡ç† + è¿›åº¦æ¨é€ï¼‰

### å½“æ™šé›†æˆéªŒè¯
```bash
# éªŒè¯æ‰€æœ‰APIç«¯ç‚¹å¯ç”¨
curl -X POST http://localhost:8000/api/analyze
curl http://localhost:8000/api/status/{task_id}
curl -N http://localhost:8000/api/analyze/stream/{task_id}
curl http://localhost:8000/api/report/{task_id}
```

### Day 4 é‡Œç¨‹ç¢‘
- âœ… APIå±‚100%å®Œæˆï¼ˆPRD-02ï¼‰
- âœ… ä¸º Day 5 å‰ç«¯å¯åŠ¨åšå¥½å‡†å¤‡

---

## ğŸ‘¨â€ğŸ’» Backend Aï¼ˆèµ„æ·±åç«¯ï¼‰ä»»åŠ¡æ¸…å•

### æ ¸å¿ƒä»»åŠ¡ï¼šå®Œæˆ3ä¸ªAPIç«¯ç‚¹

#### 1ï¸âƒ£ GET /api/status/{task_id}ï¼ˆä¼˜å…ˆçº§ P0ï¼‰

**æ–‡ä»¶**: `backend/app/api/routes/tasks.py`ï¼ˆå·²æœ‰åŸºç¡€ï¼Œéœ€è¡¥å……ï¼‰

**åŠŸèƒ½è¦æ±‚**:
- [ ] æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ï¼ˆä»æ•°æ®åº“ï¼‰
- [ ] å¤šç§Ÿæˆ·æƒé™æ£€æŸ¥ï¼ˆJWT tokenéªŒè¯ + user_idåŒ¹é…ï¼‰
- [ ] è¿”å›ä»»åŠ¡è¯¦æƒ…ï¼šstatus, progress, error_message, retry_countç­‰
- [ ] é”™è¯¯å¤„ç†ï¼š404ï¼ˆä»»åŠ¡ä¸å­˜åœ¨ï¼‰, 403ï¼ˆæ— æƒé™ï¼‰

**å®ç°è¦ç‚¹**:
```python
@router.get("/status/{task_id}", response_model=TaskStatusResponse)
async def get_task_status(
    task_id: UUID,
    payload: TokenPayload = Depends(decode_jwt_token),
    db: AsyncSession = Depends(get_session),
) -> TaskStatusResponse:
    # 1. éªŒè¯ç”¨æˆ·æƒé™
    # 2. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
    # 3. è¿”å›è¯¦ç»†ä¿¡æ¯
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç«¯ç‚¹å¯è®¿é—®
- [ ] æƒé™æ£€æŸ¥æ­£ç¡®ï¼ˆåªèƒ½æŸ¥è¯¢è‡ªå·±çš„ä»»åŠ¡ï¼‰
- [ ] å“åº”æ—¶é—´ <200ms
- [ ] æµ‹è¯•ç”¨ä¾‹é€šè¿‡ï¼ˆè‡³å°‘2ä¸ªæµ‹è¯•ï¼‰

---

#### 2ï¸âƒ£ GET /api/analyze/stream/{task_id}ï¼ˆä¼˜å…ˆçº§ P0 - æ ¸å¿ƒï¼‰

**æ–‡ä»¶**: `backend/app/api/routes/stream.py`ï¼ˆæ–°å»ºï¼‰

**åŠŸèƒ½è¦æ±‚**:
- [ ] å®ç° SSE ç«¯ç‚¹ï¼ˆServer-Sent Eventsï¼‰
- [ ] å®ç° event_generator å¼‚æ­¥ç”Ÿæˆå™¨
- [ ] æ¨é€5ç§äº‹ä»¶ï¼š
  - [ ] connected - è¿æ¥å»ºç«‹
  - [ ] progress - è¿›åº¦æ›´æ–°ï¼ˆä»Redisç¼“å­˜è¯»å–ï¼‰
  - [ ] completed - ä»»åŠ¡å®Œæˆ
  - [ ] error - ä»»åŠ¡å¤±è´¥
  - [ ] close - è¿æ¥å…³é—­
- [ ] å¿ƒè·³æœºåˆ¶ï¼ˆæ¯30ç§’å‘é€heartbeatäº‹ä»¶ï¼‰
- [ ] å¤šç§Ÿæˆ·æƒé™æ£€æŸ¥

**æŠ€æœ¯è¦ç‚¹**:
```python
from fastapi import APIRouter
from sse_starlette.sse import EventSourceResponse
import asyncio

router = APIRouter(prefix="/analyze", tags=["analysis"])

async def event_generator(task_id: str, user_id: UUID):
    """SSE äº‹ä»¶ç”Ÿæˆå™¨"""
    # 1. å‘é€è¿æ¥å»ºç«‹äº‹ä»¶
    yield {
        "event": "connected",
        "data": json.dumps({"task_id": task_id})
    }

    # 2. å¾ªç¯è¯»å–ä»»åŠ¡çŠ¶æ€
    while True:
        status = await STATUS_CACHE.get_status(task_id)

        # 3. æ¨é€è¿›åº¦äº‹ä»¶
        yield {
            "event": "progress",
            "data": json.dumps(status)
        }

        # 4. æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆ
        if status["status"] in ["completed", "failed"]:
            yield {"event": "close"}
            break

        await asyncio.sleep(1)

@router.get("/stream/{task_id}")
async def stream_task_progress(
    task_id: UUID,
    payload: TokenPayload = Depends(decode_jwt_token),
    db: AsyncSession = Depends(get_session),
):
    # æƒé™éªŒè¯
    # è¿”å› EventSourceResponse
    return EventSourceResponse(
        event_generator(str(task_id), payload.user_id)
    )
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] SSEè¿æ¥æˆåŠŸå»ºç«‹
- [ ] äº‹ä»¶æ ¼å¼ç¬¦åˆPRD-02è§„èŒƒ
- [ ] å¿ƒè·³æœºåˆ¶å·¥ä½œæ­£å¸¸ï¼ˆæ¯30ç§’ï¼‰
- [ ] æ–­çº¿é‡è¿æµ‹è¯•é€šè¿‡
- [ ] æƒé™æ£€æŸ¥æ­£ç¡®

**ä¾èµ–**:
- éœ€è¦å®‰è£…: `pip install sse-starlette`
- éœ€è¦ Backend B å®Œæˆä»»åŠ¡è¿›åº¦æ¨é€åˆ°Redis

---

#### 3ï¸âƒ£ GET /api/report/{task_id}ï¼ˆä¼˜å…ˆçº§ P1ï¼‰

**æ–‡ä»¶**: `backend/app/api/routes/reports.py`ï¼ˆæ–°å»ºï¼‰

**åŠŸèƒ½è¦æ±‚**:
- [ ] æŸ¥è¯¢å®Œæ•´åˆ†ææŠ¥å‘Š
- [ ] å¤šç§Ÿæˆ·æƒé™æ£€æŸ¥
- [ ] è¿”å›ï¼šç—›ç‚¹ã€ç«å“ã€æœºä¼šã€æ¥æºç­‰
- [ ] é”™è¯¯å¤„ç†ï¼š404ï¼ˆæŠ¥å‘Šä¸å­˜åœ¨ï¼‰, 409ï¼ˆä»»åŠ¡æœªå®Œæˆï¼‰

**å®ç°è¦ç‚¹**:
```python
@router.get("/report/{task_id}", response_model=ReportResponse)
async def get_analysis_report(
    task_id: UUID,
    payload: TokenPayload = Depends(decode_jwt_token),
    db: AsyncSession = Depends(get_session),
) -> ReportResponse:
    # 1. æƒé™éªŒè¯
    # 2. æ£€æŸ¥ä»»åŠ¡çŠ¶æ€ï¼ˆå¿…é¡»completedï¼‰
    # 3. æŸ¥è¯¢ Analysis + Report
    # 4. è¿”å›å®Œæ•´æŠ¥å‘Šæ•°æ®
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç«¯ç‚¹å¯è®¿é—®
- [ ] è¿”å›å®Œæ•´æŠ¥å‘Šæ•°æ®
- [ ] æƒé™æ£€æŸ¥æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ˆ409: ä»»åŠ¡æœªå®Œæˆï¼‰

---

### ğŸ“ æµ‹è¯•ä»»åŠ¡

**æ–‡ä»¶**: `backend/tests/api/test_stream.py`ï¼ˆæ–°å»ºï¼‰

**æµ‹è¯•ç”¨ä¾‹**:
- [ ] `test_sse_connection_established` - SSEè¿æ¥å»ºç«‹
- [ ] `test_sse_events_pushed` - äº‹ä»¶æ¨é€
- [ ] `test_sse_heartbeat_mechanism` - å¿ƒè·³æœºåˆ¶
- [ ] `test_sse_permission_check` - æƒé™æ£€æŸ¥

**æ–‡ä»¶**: `backend/tests/api/test_reports.py`ï¼ˆæ–°å»ºï¼‰

**æµ‹è¯•ç”¨ä¾‹**:
- [ ] `test_get_report_success` - æˆåŠŸè·å–æŠ¥å‘Š
- [ ] `test_get_report_permission_denied` - æƒé™æ‹’ç»
- [ ] `test_get_report_task_not_completed` - ä»»åŠ¡æœªå®Œæˆï¼ˆ409ï¼‰

---

### ğŸ“Š Backend A äº¤ä»˜æ¸…å•

| åºå· | äº¤ä»˜ç‰© | æ–‡ä»¶ä½ç½® | éªŒæ”¶æ ‡å‡† |
|------|-------|---------|---------|
| 1 | GET /api/status/{task_id} | `routes/tasks.py` | å“åº”<200ms, æƒé™æ£€æŸ¥âœ… |
| 2 | GET /api/analyze/stream/{task_id} | `routes/stream.py` | SSEè¿æ¥âœ…, äº‹ä»¶æ¨é€âœ… |
| 3 | GET /api/report/{task_id} | `routes/reports.py` | è¿”å›å®Œæ•´æŠ¥å‘Šâœ… |
| 4 | SSE æµ‹è¯• | `tests/api/test_stream.py` | æµ‹è¯•é€šè¿‡âœ… |
| 5 | æŠ¥å‘Šæµ‹è¯• | `tests/api/test_reports.py` | æµ‹è¯•é€šè¿‡âœ… |
| 6 | mypy --strict | å…¨éƒ¨ä»£ç  | 0 errors âœ… |
| 7 | pytest | å…¨éƒ¨æµ‹è¯• | æ‰€æœ‰æµ‹è¯•é€šè¿‡âœ… |

**é¢„è®¡å®Œæˆæ—¶é—´**: 8å°æ—¶
- GET /api/status: 2h
- GET /api/analyze/stream: 4hï¼ˆæœ€å¤æ‚ï¼‰
- GET /api/report: 1h
- æµ‹è¯• + éªŒè¯: 1h

---

## ğŸ”§ Backend Bï¼ˆä¸­çº§åç«¯ï¼‰ä»»åŠ¡æ¸…å•

### æ ¸å¿ƒä»»åŠ¡ï¼šå®Œæˆä»»åŠ¡ç³»ç»Ÿé›†æˆ

#### 1ï¸âƒ£ å®ç°ä»»åŠ¡çŠ¶æ€ç®¡ç†ï¼ˆä¼˜å…ˆçº§ P0ï¼‰

**å½“å‰çŠ¶æ€**: å·²æœ‰ `TaskStatusCache` (Redisç¼“å­˜)

**è¡¥å……åŠŸèƒ½**:
- [ ] ä»»åŠ¡çŠ¶æ€å†™å…¥é€»è¾‘ï¼ˆä»Celery taskå†™å…¥Redisï¼‰
- [ ] ä»»åŠ¡è¿›åº¦æ¨é€é€»è¾‘ï¼ˆæ›´æ–°Redisç¼“å­˜ï¼‰
- [ ] çŠ¶æ€åŒæ­¥æœºåˆ¶ï¼ˆRedis â†’ PostgreSQLï¼‰

**æ–‡ä»¶**: `backend/app/services/task_status_cache.py`ï¼ˆå·²æœ‰ï¼Œéœ€è¡¥å……ï¼‰

**å®ç°è¦ç‚¹**:
```python
class TaskStatusCache:
    async def set_status(self, payload: TaskStatusPayload) -> None:
        """å†™å…¥ä»»åŠ¡çŠ¶æ€åˆ°Redis"""
        # 1. åºåˆ—åŒ–payload
        # 2. å†™å…¥Redis (key: task:{task_id}, ttl: 1å°æ—¶)
        # 3. å‘å¸ƒè®¢é˜…é€šçŸ¥ï¼ˆå¯é€‰ï¼‰

    async def get_status(self, task_id: str) -> Optional[TaskStatusPayload]:
        """ä»Redisè¯»å–ä»»åŠ¡çŠ¶æ€"""
        # 1. æŸ¥è¯¢Redis
        # 2. å¦‚æœä¸å­˜åœ¨ï¼Œä»æ•°æ®åº“å›é€€
        # 3. è¿”å›çŠ¶æ€
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] çŠ¶æ€å†™å…¥åŠŸèƒ½æ­£å¸¸
- [ ] çŠ¶æ€è¯»å–åŠŸèƒ½æ­£å¸¸
- [ ] Redis â†’ DB åŒæ­¥é€»è¾‘æ­£ç¡®

---

#### 2ï¸âƒ£ å®ç°ä»»åŠ¡è¿›åº¦æ¨é€ï¼ˆä¼˜å…ˆçº§ P0ï¼‰

**åŠŸèƒ½è¦æ±‚**:
- [ ] åœ¨ Celery task ä¸­å®æ—¶æ›´æ–°ä»»åŠ¡çŠ¶æ€åˆ°Redis
- [ ] æ¨é€è¿›åº¦äº‹ä»¶ï¼ˆ0% â†’ 25% â†’ 50% â†’ 75% â†’ 100%ï¼‰
- [ ] æ¨é€å½“å‰æ­¥éª¤ä¿¡æ¯ï¼ˆ"ç¤¾åŒºå‘ç°" â†’ "æ•°æ®é‡‡é›†" â†’ ...ï¼‰

**ä¿®æ”¹æ–‡ä»¶**: `backend/app/tasks/analysis_task.py`ï¼ˆå·²æœ‰åŸºç¡€ï¼‰

**å…³é”®ä»£ç ä½ç½®**:
```python
async def _execute_success_flow(task_id: uuid.UUID, retries: int) -> None:
    summary = await _mark_processing(task_id, retries)

    # æ¨é€è¿›åº¦ï¼š10% - ä»»åŠ¡å¼€å§‹
    await _cache_status(
        str(task_id),
        TaskStatus.PROCESSING,
        progress=10,
        message="ä»»åŠ¡å¼€å§‹å¤„ç†"
    )

    # æ¨é€è¿›åº¦ï¼š25% - ç¤¾åŒºå‘ç°
    await _cache_status(
        str(task_id),
        TaskStatus.PROCESSING,
        progress=25,
        message="æ­£åœ¨å‘ç°ç›¸å…³ç¤¾åŒº..."
    )

    # æ‰§è¡Œåˆ†æå¼•æ“
    result = await run_analysis(summary)

    # æ¨é€è¿›åº¦ï¼š75% - åˆ†æå®Œæˆ
    await _cache_status(
        str(task_id),
        TaskStatus.PROCESSING,
        progress=75,
        message="åˆ†æå®Œæˆï¼Œç”ŸæˆæŠ¥å‘Šä¸­..."
    )

    await _store_analysis_results(task_id, result)

    # æ¨é€è¿›åº¦ï¼š100% - ä»»åŠ¡å®Œæˆ
    await _cache_status(
        str(task_id),
        TaskStatus.COMPLETED,
        progress=100,
        message="åˆ†æå®Œæˆ"
    )
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] è¿›åº¦æ›´æ–°å®æ—¶æ¨é€åˆ°Redis
- [ ] è¿›åº¦ç™¾åˆ†æ¯”æ­£ç¡®ï¼ˆ0-100ï¼‰
- [ ] æ­¥éª¤ä¿¡æ¯æ¸…æ™°æ˜ç¡®

---

#### 3ï¸âƒ£ ä»»åŠ¡ç³»ç»Ÿæµ‹è¯•ï¼ˆä¼˜å…ˆçº§ P1ï¼‰

**æ–‡ä»¶**: `backend/tests/test_task_system.py`ï¼ˆæ–°å»ºï¼‰

**æµ‹è¯•ç”¨ä¾‹**:
- [ ] `test_task_status_cache_integration` - Redisç¼“å­˜é›†æˆ
- [ ] `test_task_progress_update` - è¿›åº¦æ›´æ–°
- [ ] `test_task_status_sync_to_db` - çŠ¶æ€åŒæ­¥åˆ°DB
- [ ] `test_celery_task_execution_flow` - Celeryä»»åŠ¡æ‰§è¡Œæµç¨‹

---

#### 4ï¸âƒ£ Worker éªŒè¯ä¸æ–‡æ¡£ï¼ˆä¼˜å…ˆçº§ P2ï¼‰

**ä»»åŠ¡**:
- [ ] å¯åŠ¨ Celery Worker å¹¶éªŒè¯ä»»åŠ¡æ‰§è¡Œ
- [ ] è¡¥å…… Worker è¿ç»´æ–‡æ¡£
- [ ] è®°å½•å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

**æ–‡ä»¶**: `backend/docs/WORKER_OPS.md`ï¼ˆæ–°å»ºï¼‰

**æ–‡æ¡£å†…å®¹**:
```markdown
# Celery Worker è¿ç»´æ–‡æ¡£

## å¯åŠ¨ Worker
python backend/scripts/start_celery_worker.py

## éªŒè¯ Worker çŠ¶æ€
celery -A app.core.celery_app inspect active

## ç›‘æ§ä»»åŠ¡é˜Ÿåˆ—
celery -A app.core.celery_app inspect stats

## å¸¸è§é—®é¢˜
- é—®é¢˜1ï¼šWorkeræ— æ³•è¿æ¥Redis
  - è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥CELERY_BROKER_URLç¯å¢ƒå˜é‡

- é—®é¢˜2ï¼šä»»åŠ¡æ‰§è¡Œå¤±è´¥
  - è§£å†³æ–¹æ¡ˆï¼šæŸ¥çœ‹Workeræ—¥å¿—
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] Workerå¯ä»¥æˆåŠŸå¯åŠ¨
- [ ] ä»»åŠ¡å¯ä»¥æ­£å¸¸æ‰§è¡Œ
- [ ] æ–‡æ¡£æ¸…æ™°å®Œæ•´

---

### ğŸ“Š Backend B äº¤ä»˜æ¸…å•

| åºå· | äº¤ä»˜ç‰© | æ–‡ä»¶ä½ç½® | éªŒæ”¶æ ‡å‡† |
|------|-------|---------|---------|
| 1 | ä»»åŠ¡çŠ¶æ€ç®¡ç† | `services/task_status_cache.py` | çŠ¶æ€åŒæ­¥âœ… |
| 2 | ä»»åŠ¡è¿›åº¦æ¨é€ | `tasks/analysis_task.py` | å®æ—¶æ¨é€âœ… |
| 3 | ä»»åŠ¡ç³»ç»Ÿæµ‹è¯• | `tests/test_task_system.py` | æµ‹è¯•é€šè¿‡âœ… |
| 4 | Workeræ–‡æ¡£ | `docs/WORKER_OPS.md` | æ–‡æ¡£å®Œæ•´âœ… |
| 5 | mypy --strict | å…¨éƒ¨ä»£ç  | 0 errors âœ… |
| 6 | pytest | å…¨éƒ¨æµ‹è¯• | æ‰€æœ‰æµ‹è¯•é€šè¿‡âœ… |

**é¢„è®¡å®Œæˆæ—¶é—´**: 8å°æ—¶
- ä»»åŠ¡çŠ¶æ€ç®¡ç†: 2h
- ä»»åŠ¡è¿›åº¦æ¨é€: 3h
- æµ‹è¯• + æ–‡æ¡£: 2h
- WorkeréªŒè¯: 1h

---

## ğŸ¨ Frontendï¼ˆå…¨æ ˆå‰ç«¯ï¼‰ä»»åŠ¡æ¸…å•

### æ ¸å¿ƒä»»åŠ¡ï¼šå­¦ä¹ ä¸å‡†å¤‡

#### 1ï¸âƒ£ å­¦ä¹  SSE å®¢æˆ·ç«¯å®ç°ï¼ˆä¼˜å…ˆçº§ P0ï¼‰

**å­¦ä¹ å†…å®¹**:
- [ ] EventSource API ä½¿ç”¨æ–¹æ³•
- [ ] SSE äº‹ä»¶ç›‘å¬ä¸å¤„ç†
- [ ] SSE æ–­çº¿é‡è¿æœºåˆ¶
- [ ] SSE é™çº§åˆ°è½®è¯¢çš„ç­–ç•¥

**å­¦ä¹ èµ„æº**:
- MDN EventSource æ–‡æ¡£: https://developer.mozilla.org/en-US/docs/Web/API/EventSource
- å‰ç«¯å·²å®ç°çš„ `frontend/src/api/sse.client.ts` (Day 2å‡†å¤‡å·¥ä½œ)
- å‰ç«¯å·²å®ç°çš„ `frontend/src/hooks/useSSE.ts` (è‡ªå®šä¹‰Hook)

**å­¦ä¹ äº§å‡º**:
- [ ] ç†è§£ EventSource API çš„å·¥ä½œåŸç†
- [ ] èƒ½å¤Ÿä½¿ç”¨ç°æœ‰çš„ SSEClient ç±»
- [ ] ç†è§£ useSSE Hook çš„ä½¿ç”¨æ–¹æ³•

---

#### 2ï¸âƒ£ é¡¹ç›®ç»“æ„ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ P1ï¼‰

**ä»»åŠ¡**:
- [ ] å®Œå–„å‰ç«¯è·¯ç”±é…ç½®
- [ ] ä¼˜åŒ–é¡µé¢ç»„ä»¶ç»“æ„
- [ ] å‡†å¤‡çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼ˆå¦‚Zustand/Jotai/Context APIï¼‰
- [ ] é…ç½®ç¯å¢ƒå˜é‡ï¼ˆVITE_API_BASE_URLï¼‰

**æ–‡ä»¶æ£€æŸ¥**:
- [ ] `frontend/.env.example` - ç¯å¢ƒå˜é‡æ¨¡æ¿
- [ ] `frontend/src/router/index.tsx` - è·¯ç”±é…ç½®
- [ ] `frontend/src/App.tsx` - åº”ç”¨å…¥å£

**éªŒæ”¶æ ‡å‡†**:
- [ ] è·¯ç”±é…ç½®æ¸…æ™°
- [ ] ç¯å¢ƒå˜é‡é…ç½®å®Œæˆ
- [ ] é¡¹ç›®ç»“æ„åˆç†

---

#### 3ï¸âƒ£ API ç±»å‹å®šä¹‰éªŒè¯ï¼ˆä¼˜å…ˆçº§ P1ï¼‰

**ä»»åŠ¡**:
- [ ] å¯¹æ¯”åç«¯APIå®ç°ï¼ŒéªŒè¯TypeScriptç±»å‹å®šä¹‰
- [ ] æ›´æ–° `frontend/src/types/*.ts`ï¼ˆå¦‚æœ‰å˜åŒ–ï¼‰
- [ ] ç¡®ä¿ç±»å‹å®šä¹‰ä¸åç«¯Schemaä¸€è‡´

**æ£€æŸ¥æ–‡ä»¶**:
- `frontend/src/types/task.types.ts`
- `frontend/src/types/api.types.ts`
- `frontend/src/types/sse.types.ts`

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç±»å‹å®šä¹‰ä¸åç«¯ä¸€è‡´
- [ ] TypeScript ç¼–è¯‘é€šè¿‡ï¼ˆå¦‚æœå¯ä»¥è¿è¡Œ `npm run type-check`ï¼‰

---

#### 4ï¸âƒ£ ç­‰å¾… Day 5 API äº¤æ¥ä¼šï¼ˆé˜»å¡çŠ¶æ€ï¼‰

**å‡†å¤‡å·¥ä½œ**:
- [ ] é˜…è¯» PRD-02 APIè®¾è®¡è§„èŒƒ
- [ ] é˜…è¯» PRD-05 å‰ç«¯äº¤äº’è®¾è®¡
- [ ] å‡†å¤‡APIè°ƒè¯•å·¥å…·ï¼ˆPostman/Thunder Client/curlï¼‰
- [ ] ç­‰å¾… Day 5 æ—©ä¸Š 9:00 API äº¤æ¥ä¼š

**Day 5 äº¤æ¥ä¼šå†…å®¹**:
1. Backend A æ¼”ç¤º4ä¸ªAPIç«¯ç‚¹
2. å‰ç«¯è·å–APIæ–‡æ¡£ï¼ˆOpenAPI/Swaggerï¼‰
3. å‰ç«¯è·å–æµ‹è¯•token
4. ç¡®è®¤æ¥å£å­—æ®µå®šä¹‰
5. å‰ç«¯å¼€å§‹å¼€å‘

---

### ğŸ“Š Frontend äº¤ä»˜æ¸…å•

| åºå· | äº¤ä»˜ç‰© | éªŒæ”¶æ ‡å‡† |
|------|-------|---------|
| 1 | å­¦ä¹  SSE å®¢æˆ·ç«¯ | ç†è§£ EventSource API âœ… |
| 2 | é¡¹ç›®ç»“æ„ä¼˜åŒ– | è·¯ç”±é…ç½®å®Œå–„âœ…, ç¯å¢ƒå˜é‡é…ç½®âœ… |
| 3 | ç±»å‹å®šä¹‰éªŒè¯ | ç±»å‹ä¸€è‡´æ€§âœ… |
| 4 | å‡†å¤‡ API å¯¹æ¥ | ç¯å¢ƒé…ç½®å®Œæˆâœ…, è°ƒè¯•å·¥å…·å‡†å¤‡âœ… |

**é¢„è®¡å®Œæˆæ—¶é—´**: 6å°æ—¶
- å­¦ä¹  SSE å®¢æˆ·ç«¯: 3h
- é¡¹ç›®ç»“æ„ä¼˜åŒ–: 2h
- ç±»å‹å®šä¹‰éªŒè¯: 1h

---

## ğŸ”— Day 4 åä½œèŠ‚ç‚¹

### åä½œèŠ‚ç‚¹ 1: ä¸Šåˆ 10:00 - å¿«é€ŸåŒæ­¥ä¼šï¼ˆ15åˆ†é’Ÿï¼‰

**å‚ä¸è€…**: Backend A + Backend B

**è®¨è®ºå†…å®¹**:
1. Backend A: åŒæ­¥ SSE ç«¯ç‚¹è®¾è®¡æ–¹æ¡ˆ
2. Backend B: åŒæ­¥ä»»åŠ¡è¿›åº¦æ¨é€æ–¹æ¡ˆ
3. ç¡®è®¤ Redis ç¼“å­˜æ•°æ®æ ¼å¼ï¼ˆTaskStatusPayloadï¼‰
4. ç¡®è®¤ SSE äº‹ä»¶æ ¼å¼ï¼ˆevent, dataï¼‰

**äº§å‡º**:
- Redis æ•°æ®æ ¼å¼ç¡®è®¤
- SSE äº‹ä»¶æ ¼å¼ç¡®è®¤
- åŒæ–¹æ— é˜»å¡é—®é¢˜

---

### åä½œèŠ‚ç‚¹ 2: ä¸‹åˆ 16:00 - é›†æˆæµ‹è¯•ï¼ˆ30åˆ†é’Ÿï¼‰

**å‚ä¸è€…**: Backend A + Backend B

**æµ‹è¯•æµç¨‹**:
1. Backend A å¯åŠ¨ FastAPI æœåŠ¡
   ```bash
   cd backend
   uvicorn app.main:app --reload
   ```

2. Backend B å¯åŠ¨ Celery Worker
   ```bash
   cd backend
   python scripts/start_celery_worker.py
   ```

3. ç«¯åˆ°ç«¯æµ‹è¯•ï¼š
   ```bash
   # Step 1: åˆ›å»ºä»»åŠ¡
   curl -X POST http://localhost:8000/api/analyze \
     -H "Content-Type: application/json" \
     -H "Authorization: Bearer {token}" \
     -d '{"product_description": "æµ‹è¯•äº§å“æè¿°..."}'

   # Step 2: è¿æ¥ SSE ç›‘å¬è¿›åº¦
   curl -N http://localhost:8000/api/analyze/stream/{task_id} \
     -H "Authorization: Bearer {token}"

   # Step 3: æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
   curl http://localhost:8000/api/status/{task_id} \
     -H "Authorization: Bearer {token}"

   # Step 4: è·å–æŠ¥å‘Š
   curl http://localhost:8000/api/report/{task_id} \
     -H "Authorization: Bearer {token}"
   ```

4. éªŒè¯ä»»åŠ¡çŠ¶æ€åŒæ­¥æ­£ç¡®

**éªŒæ”¶ç‚¹**:
- [ ] SSE è¿æ¥æˆåŠŸ
- [ ] è¿›åº¦äº‹ä»¶å®æ—¶æ¨é€
- [ ] ä»»åŠ¡çŠ¶æ€æ­£ç¡®
- [ ] æŠ¥å‘Šæ•°æ®å®Œæ•´

---

### åä½œèŠ‚ç‚¹ 3: æ™šä¸Š 18:00 - Day 4 éªŒæ”¶ä¼šï¼ˆ30åˆ†é’Ÿï¼‰

**å‚ä¸è€…**: å…¨å‘˜ï¼ˆBackend A + Backend B + Frontend + Leadï¼‰

**éªŒæ”¶æ¸…å•**:
```bash
âœ… 4ä¸ªAPIç«¯ç‚¹å…¨éƒ¨å¯è®¿é—®
âœ… SSEè¿æ¥æˆåŠŸå»ºç«‹å¹¶æ¨é€äº‹ä»¶
âœ… ä»»åŠ¡çŠ¶æ€ç®¡ç†æ­£å¸¸å·¥ä½œ
âœ… mypy --strict 0 errors
âœ… pytest æ‰€æœ‰æµ‹è¯•é€šè¿‡
âœ… é›†æˆæµ‹è¯•é€šè¿‡
```

**éªŒæ”¶æµç¨‹**:
1. Backend A æ¼”ç¤º3ä¸ªæ–°å¢ç«¯ç‚¹
2. Backend B æ¼”ç¤ºä»»åŠ¡è¿›åº¦æ¨é€
3. è¿è¡Œè´¨é‡é—¨ç¦æ£€æŸ¥
   ```bash
   # mypy æ£€æŸ¥
   cd backend
   python -m mypy --strict app

   # pytest æµ‹è¯•
   python -m pytest tests/ -v
   ```
4. Lead ç¡®è®¤æ‰€æœ‰éªŒæ”¶é¡¹é€šè¿‡

**éªŒæ”¶å¤±è´¥å¤„ç†**:
- å¦‚æœæœ‰æœªé€šè¿‡é¡¹ï¼Œç«‹å³åˆ†é…ä¿®å¤ä»»åŠ¡
- ä¿®å¤æ—¶é—´ä¸è¶…è¿‡1å°æ—¶
- ä¿®å¤åé‡æ–°éªŒæ”¶

---

## ğŸ“‹ Day 4 æ‰§è¡Œé¡ºåºå»ºè®®

### Backend A æ‰§è¡Œé¡ºåº
```
09:00 - 10:00  1. å®ç° GET /api/status/{task_id}ï¼ˆæœ€ç®€å•ï¼‰
10:00 - 10:15  [åŒæ­¥ä¼š] ä¸ Backend B å¯¹é½æ–¹æ¡ˆ
10:15 - 14:00  2. å®ç° GET /api/analyze/stream/{task_id}ï¼ˆæ ¸å¿ƒï¼Œæœ€å¤æ‚ï¼‰
14:00 - 15:00  3. å®ç° GET /api/report/{task_id}ï¼ˆä¾èµ–å‰ä¸¤ä¸ªï¼‰
15:00 - 16:00  4. ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ˆtest_stream.py, test_reports.pyï¼‰
16:00 - 16:30  [é›†æˆæµ‹è¯•] ä¸ Backend B è”è°ƒ
16:30 - 17:30  5. mypy --strict éªŒè¯ + ä¿®å¤é—®é¢˜
17:30 - 18:00  6. å‡†å¤‡éªŒæ”¶ææ–™
18:00 - 18:30  [éªŒæ”¶ä¼š] å…¨å‘˜éªŒæ”¶
```

### Backend B æ‰§è¡Œé¡ºåº
```
09:00 - 11:00  1. è¡¥å……ä»»åŠ¡çŠ¶æ€ç®¡ç†é€»è¾‘ï¼ˆtask_status_cache.pyï¼‰
11:00 - 14:00  2. å®ç°ä»»åŠ¡è¿›åº¦æ¨é€ï¼ˆanalysis_task.pyï¼‰
14:00 - 15:00  3. ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ˆtest_task_system.pyï¼‰
15:00 - 16:00  4. å¯åŠ¨ Worker éªŒè¯ä»»åŠ¡æ‰§è¡Œ
16:00 - 16:30  [é›†æˆæµ‹è¯•] ä¸ Backend A è”è°ƒ
16:30 - 17:00  5. ç¼–å†™ Worker è¿ç»´æ–‡æ¡£ï¼ˆWORKER_OPS.mdï¼‰
17:00 - 17:30  6. mypy --strict éªŒè¯ + ä¿®å¤é—®é¢˜
17:30 - 18:00  7. å‡†å¤‡éªŒæ”¶ææ–™
18:00 - 18:30  [éªŒæ”¶ä¼š] å…¨å‘˜éªŒæ”¶
```

### Frontend æ‰§è¡Œé¡ºåº
```
09:00 - 12:00  1. å­¦ä¹  SSE å®¢æˆ·ç«¯å®ç°
12:00 - 14:00  2. ä¼˜åŒ–é¡¹ç›®ç»“æ„ï¼ˆè·¯ç”± + ç¯å¢ƒå˜é‡ï¼‰
14:00 - 15:00  3. éªŒè¯ç±»å‹å®šä¹‰
15:00 - 17:00  4. é˜…è¯» PRD æ–‡æ¡£ï¼Œå‡†å¤‡ API å¯¹æ¥
17:00 - 18:00  5. å‡†å¤‡ API è°ƒè¯•å·¥å…·å’Œæµ‹è¯•ç¯å¢ƒ
18:00 - 18:30  [éªŒæ”¶ä¼š] å…¨å‘˜éªŒæ”¶ï¼ˆä¸»è¦æ˜¯è§‚å¯Ÿï¼‰
```

---

## â° Day 4 æ—¶é—´é¢„ä¼°

| è§’è‰² | ä»»åŠ¡ | é¢„ä¼°æ—¶é—´ |
|------|------|---------|
| **Backend A** | GET /api/status | 2h |
| | GET /api/analyze/streamï¼ˆSSEï¼‰ | 4h |
| | GET /api/report | 1h |
| | æµ‹è¯• + éªŒè¯ | 1h |
| | **Backend A æ€»è®¡** | **8h** |
| **Backend B** | ä»»åŠ¡çŠ¶æ€ç®¡ç† | 2h |
| | ä»»åŠ¡è¿›åº¦æ¨é€ | 3h |
| | æµ‹è¯• + æ–‡æ¡£ | 2h |
| | WorkeréªŒè¯ | 1h |
| | **Backend B æ€»è®¡** | **8h** |
| **Frontend** | å­¦ä¹  SSE | 3h |
| | é¡¹ç›®ä¼˜åŒ– | 2h |
| | ç±»å‹éªŒè¯ + å‡†å¤‡ | 1h |
| | **Frontend æ€»è®¡** | **6h** |

---

## ğŸš¨ Day 4 é£é™©æç¤ºä¸ç¼“è§£æªæ–½

### é£é™© 1: SSE å®ç°å¤æ‚åº¦é«˜

**é£é™©æè¿°**:
- SSE ç«¯ç‚¹å®ç°å¯èƒ½é‡åˆ°æŠ€æœ¯éš¾ç‚¹
- EventSource æ–­çº¿é‡è¿æœºåˆ¶å¤æ‚
- å¿ƒè·³æœºåˆ¶éœ€è¦ç²¾ç¡®æ§åˆ¶

**å½±å“**: Backend A è¿›åº¦å»¶è¿Ÿï¼Œå¯èƒ½æ— æ³•å®Œæˆ

**ç¼“è§£æªæ–½**:
1. Backend A ä¼˜å…ˆå®ç°åŸºç¡€ SSE è¿æ¥ï¼ˆä¸å¸¦å¿ƒè·³ï¼‰
2. å¦‚é‡åˆ°é—®é¢˜ï¼Œç«‹å³ä¸ Backend B åå•†
3. ä¿ç•™é™çº§æ–¹æ¡ˆï¼ˆå‰ç«¯ä½¿ç”¨è½®è¯¢ GET /api/statusï¼‰
4. å‚è€ƒ sse-starlette å®˜æ–¹æ–‡æ¡£å’Œç¤ºä¾‹

**åº”æ€¥é¢„æ¡ˆ**:
- å¦‚æœ 18:00 å‰æ— æ³•å®Œæˆ SSEï¼Œå°† SSE ç«¯ç‚¹æ¨è¿Ÿåˆ° Day 5 ä¸Šåˆ
- å‰ç«¯ Day 5 å…ˆä½¿ç”¨è½®è¯¢æ–¹å¼ï¼Œåç»­å†åˆ‡æ¢åˆ° SSE

---

### é£é™© 2: ä»»åŠ¡è¿›åº¦æ¨é€æ—¶æœºä¸å‡†ç¡®

**é£é™©æè¿°**:
- Celery ä»»åŠ¡ä¸­æ¨é€è¿›åº¦çš„æ—¶æœºä¸å‡†ç¡®
- è¿›åº¦ç™¾åˆ†æ¯”è®¡ç®—å¤æ‚
- åˆ†æå¼•æ“è€—æ—¶ä¸ç¡®å®š

**å½±å“**: å‰ç«¯è¿›åº¦æ¡ä¸å‡†ç¡®ï¼Œç”¨æˆ·ä½“éªŒå·®

**ç¼“è§£æªæ–½**:
1. Backend B å…ˆåœ¨ analysis_task.py ä¸­æ·»åŠ ç®€å•çš„è¿›åº¦æ¨é€ï¼ˆå›ºå®šç™¾åˆ†æ¯”ï¼‰
2. åç»­ Day 6-8 å†ä¼˜åŒ–æ¨é€ç²¾åº¦ï¼ˆåŸºäºåˆ†æå¼•æ“å„æ­¥éª¤è€—æ—¶ï¼‰
3. ä¿è¯è‡³å°‘æœ‰ 4 ä¸ªè¿›åº¦æ›´æ–°ç‚¹ï¼š0%, 25%, 75%, 100%

**åº”æ€¥é¢„æ¡ˆ**:
- å¦‚æœç²¾ç¡®è¿›åº¦éš¾ä»¥å®ç°ï¼Œå…ˆä½¿ç”¨ç®€å•çš„é˜¶æ®µæ€§è¿›åº¦ï¼ˆ3-5ä¸ªé˜¶æ®µï¼‰
- åç»­è¿­ä»£ä¼˜åŒ–

---

### é£é™© 3: å‰ç«¯ç­‰å¾…æ—¶é—´é•¿ï¼Œç§¯ææ€§å—å½±å“

**é£é™©æè¿°**:
- å‰ç«¯ Day 4 ä»»åŠ¡è¾ƒè½»ï¼Œä¸»è¦æ˜¯å­¦ä¹ å’Œå‡†å¤‡
- å¯èƒ½æ„Ÿè§‰è¢«é˜»å¡ï¼Œæ— æ³•å®é™…å¼€å‘

**å½±å“**: å‰ç«¯æˆå‘˜ç§¯ææ€§ä¸‹é™

**ç¼“è§£æªæ–½**:
1. æ˜ç¡®å‘ŠçŸ¥å‰ç«¯ï¼šDay 5 æ‰èƒ½å¼€å§‹å¼€å‘ï¼ˆè¿™æ˜¯è®¡åˆ’è®¾è®¡ï¼‰
2. å¼•å¯¼å‰ç«¯åˆ©ç”¨ Day 4 å……åˆ†å­¦ä¹ å’Œå‡†å¤‡
3. é¼“åŠ±å‰ç«¯æ·±å…¥å­¦ä¹  SSEã€React 18 æ–°ç‰¹æ€§
4. å‰ç«¯å¯ä»¥å‚ä¸ä¸‹åˆ 16:00 çš„é›†æˆæµ‹è¯•ï¼Œè§‚å¯Ÿåç«¯ API

**æ²Ÿé€šè¯æœ¯**:
> "Day 4 æ˜¯åç«¯ API å®Œæˆçš„å…³é”®æ—¥ï¼Œå‰ç«¯åˆ©ç”¨è¿™ä¸€å¤©å……åˆ†å­¦ä¹  SSE å’Œå‡†å¤‡ç¯å¢ƒï¼ŒDay 5 æ—©ä¸Š 9:00 API äº¤æ¥ä¼šåï¼Œå‰ç«¯å°±å¯ä»¥å…¨é€Ÿå¼€å‘äº†ã€‚è¿™ä¸€å¤©çš„å­¦ä¹ å’Œå‡†å¤‡ä¼šè®© Day 5-11 çš„å¼€å‘æ›´åŠ é¡ºåˆ©ã€‚"

---

### é£é™© 4: é›†æˆæµ‹è¯•å¤±è´¥

**é£é™©æè¿°**:
- ä¸‹åˆ 16:00 é›†æˆæµ‹è¯•æ—¶ï¼Œå¯èƒ½å‘ç° Backend A + Backend B æ¥å£ä¸åŒ¹é…
- Redis æ•°æ®æ ¼å¼ä¸ä¸€è‡´
- SSE äº‹ä»¶æ ¼å¼ä¸ä¸€è‡´

**å½±å“**: Day 4 æ— æ³•éªŒæ”¶é€šè¿‡

**ç¼“è§£æªæ–½**:
1. ä¸Šåˆ 10:00 å¿«é€ŸåŒæ­¥ä¼šï¼Œæå‰å¯¹é½æ¥å£æ ¼å¼
2. Backend B å…ˆå®Œæˆä»»åŠ¡çŠ¶æ€ç®¡ç†ï¼ŒBackend A å†å¼€å§‹ SSE å¼€å‘
3. å®šä¹‰æ¸…æ™°çš„æ•°æ®æ ¼å¼æ–‡æ¡£ï¼ˆTaskStatusPayload, SSEEventï¼‰

**åº”æ€¥é¢„æ¡ˆ**:
- å¦‚æœé›†æˆæµ‹è¯•å¤±è´¥ï¼Œç«‹å³åˆ†é…ä¿®å¤ä»»åŠ¡ï¼ˆä¸è¶…è¿‡1å°æ—¶ï¼‰
- å¦‚æœé—®é¢˜å¤æ‚ï¼Œå°†éƒ¨åˆ†åŠŸèƒ½æ¨è¿Ÿåˆ° Day 5 ä¸Šåˆ

---

## âœ… Day 4 éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

#### Backend A åŠŸèƒ½éªŒæ”¶
- [ ] âœ… GET /api/status/{task_id} ç«¯ç‚¹å¯è®¿é—®
- [ ] âœ… GET /api/analyze/stream/{task_id} SSEè¿æ¥æˆåŠŸ
- [ ] âœ… GET /api/report/{task_id} ç«¯ç‚¹å¯è®¿é—®
- [ ] âœ… å¤šç§Ÿæˆ·æƒé™æ£€æŸ¥æ­£ç¡®ï¼ˆæ‰€æœ‰ç«¯ç‚¹ï¼‰
- [ ] âœ… é”™è¯¯å¤„ç†å®Œå–„ï¼ˆ404, 403, 409ï¼‰

#### Backend B åŠŸèƒ½éªŒæ”¶
- [ ] âœ… ä»»åŠ¡çŠ¶æ€ç®¡ç†å·¥ä½œæ­£å¸¸ï¼ˆå†™å…¥/è¯»å–Redisï¼‰
- [ ] âœ… ä»»åŠ¡è¿›åº¦æ¨é€å®æ—¶æ›´æ–°ï¼ˆè‡³å°‘4ä¸ªè¿›åº¦ç‚¹ï¼‰
- [ ] âœ… Celery Worker å¯ä»¥æ­£å¸¸å¯åŠ¨å’Œæ‰§è¡Œä»»åŠ¡
- [ ] âœ… ä»»åŠ¡çŠ¶æ€åŒæ­¥æ­£ç¡®ï¼ˆRedis â†” PostgreSQLï¼‰

#### Frontend åŠŸèƒ½éªŒæ”¶
- [ ] âœ… SSE å®¢æˆ·ç«¯åŸç†æ¸…æ¥š
- [ ] âœ… é¡¹ç›®ç»“æ„ä¼˜åŒ–å®Œæˆ
- [ ] âœ… ç±»å‹å®šä¹‰éªŒè¯é€šè¿‡
- [ ] âœ… API å¯¹æ¥ç¯å¢ƒå‡†å¤‡å®Œæˆ

---

### è´¨é‡éªŒæ”¶

#### ä»£ç è´¨é‡
- [ ] âœ… **mypy --strict**: 0 errorsï¼ˆ32 filesï¼‰
- [ ] âœ… **pytest**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆé¢„è®¡ 10+ testsï¼‰
- [ ] âœ… **black**: ä»£ç æ ¼å¼åŒ–é€šè¿‡
- [ ] âœ… **isort**: å¯¼å…¥æ’åºæ­£ç¡®

#### æµ‹è¯•è¦†ç›–
- [ ] âœ… Backend A: è‡³å°‘æ–°å¢ 5 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - test_stream.py: 4 ä¸ªæµ‹è¯•
  - test_reports.py: 1 ä¸ªæµ‹è¯•
- [ ] âœ… Backend B: è‡³å°‘æ–°å¢ 4 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - test_task_system.py: 4 ä¸ªæµ‹è¯•

#### API æ€§èƒ½
- [ ] âœ… GET /api/status/{task_id}: å“åº”æ—¶é—´ <200ms
- [ ] âœ… GET /api/analyze/stream/{task_id}: è¿æ¥å»ºç«‹ <500ms
- [ ] âœ… GET /api/report/{task_id}: å“åº”æ—¶é—´ <500ms

---

### é›†æˆéªŒæ”¶

#### ç«¯åˆ°ç«¯æµç¨‹
- [ ] âœ… å®Œæ•´æµç¨‹å¯è·‘é€šï¼š
  ```
  POST /api/analyze
    â†’ SSE stream å®æ—¶ç›‘å¬è¿›åº¦
    â†’ GET /api/status æŸ¥è¯¢çŠ¶æ€
    â†’ GET /api/report è·å–æŠ¥å‘Š
  ```

#### ä»»åŠ¡çŠ¶æ€åŒæ­¥
- [ ] âœ… Celery â†’ Redis: çŠ¶æ€å®æ—¶å†™å…¥
- [ ] âœ… Redis â†’ PostgreSQL: çŠ¶æ€æœ€ç»ˆæŒä¹…åŒ–
- [ ] âœ… Redis ç¼“å­˜è¿‡æœŸåï¼Œè‡ªåŠ¨ä» PostgreSQL å›é€€

#### SSE äº‹ä»¶éªŒè¯
- [ ] âœ… SSE äº‹ä»¶æ ¼å¼ç¬¦åˆ PRD-02 è§„èŒƒ
- [ ] âœ… äº‹ä»¶ç±»å‹å®Œæ•´ï¼šconnected, progress, completed, error, close
- [ ] âœ… å¿ƒè·³æœºåˆ¶æ­£å¸¸ï¼ˆæ¯30ç§’ä¸€æ¬¡ï¼‰

---

### æ–‡æ¡£éªŒæ”¶

- [ ] âœ… `backend/docs/WORKER_OPS.md` - Worker è¿ç»´æ–‡æ¡£å®Œæ•´
- [ ] âœ… ä»£ç æ³¨é‡Šæ¸…æ™°ï¼ˆç‰¹åˆ«æ˜¯ SSE äº‹ä»¶ç”Ÿæˆå™¨ï¼‰
- [ ] âœ… API ç«¯ç‚¹æ–‡æ¡£æ›´æ–°ï¼ˆå¦‚æœ‰ Swagger/OpenAPIï¼‰

---

## ğŸ“Š éªŒæ”¶æµç¨‹

### Step 1: ä»£ç è´¨é‡æ£€æŸ¥ï¼ˆ17:30-17:45ï¼‰

```bash
# Backend è´¨é‡æ£€æŸ¥
cd backend

# 1. mypy ç±»å‹æ£€æŸ¥
python -m mypy --strict app
# æœŸæœ›: Success: no issues found in 32 source files

# 2. pytest æµ‹è¯•
python -m pytest tests/ -v
# æœŸæœ›: X passed in Xs

# 3. black æ ¼å¼åŒ–æ£€æŸ¥
black app --check
# æœŸæœ›: All done! âœ¨ ğŸ° âœ¨

# 4. isort å¯¼å…¥æ’åºæ£€æŸ¥
isort app --check
# æœŸæœ›: All done! âœ¨ ğŸ° âœ¨
```

---

### Step 2: åŠŸèƒ½æ¼”ç¤ºï¼ˆ17:45-18:00ï¼‰

#### Backend A æ¼”ç¤º
```bash
# 1. å¯åŠ¨ FastAPI æœåŠ¡
uvicorn app.main:app --reload

# 2. æ¼”ç¤º GET /api/status/{task_id}
curl http://localhost:8000/api/status/{task_id} \
  -H "Authorization: Bearer {token}"

# 3. æ¼”ç¤º SSE stream
curl -N http://localhost:8000/api/analyze/stream/{task_id} \
  -H "Authorization: Bearer {token}"

# 4. æ¼”ç¤º GET /api/report/{task_id}
curl http://localhost:8000/api/report/{task_id} \
  -H "Authorization: Bearer {token}"
```

#### Backend B æ¼”ç¤º
```bash
# 1. å¯åŠ¨ Celery Worker
python scripts/start_celery_worker.py

# 2. æ¼”ç¤ºä»»åŠ¡è¿›åº¦æ¨é€
# (é€šè¿‡ Backend A çš„ SSE è§‚å¯Ÿ)

# 3. æ¼”ç¤º Worker æ–‡æ¡£
cat docs/WORKER_OPS.md
```

---

### Step 3: é›†æˆæµ‹è¯•éªŒè¯ï¼ˆ18:00-18:15ï¼‰

```bash
# å®Œæ•´æµç¨‹æµ‹è¯•è„šæœ¬
cd backend

# 1. åˆ›å»ºä»»åŠ¡
TASK_ID=$(curl -X POST http://localhost:8000/api/analyze \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {token}" \
  -d '{"product_description": "æµ‹è¯•äº§å“æè¿°ï¼Œè‡³å°‘10ä¸ªå­—ç¬¦"}' \
  | jq -r '.task_id')

echo "Task ID: $TASK_ID"

# 2. è¿æ¥ SSE ç›‘å¬è¿›åº¦ï¼ˆå¦ä¸€ä¸ªç»ˆç«¯ï¼‰
curl -N http://localhost:8000/api/analyze/stream/$TASK_ID \
  -H "Authorization: Bearer {token}"

# 3. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
curl http://localhost:8000/api/status/$TASK_ID \
  -H "Authorization: Bearer {token}"

# 4. ç­‰å¾…ä»»åŠ¡å®Œæˆåï¼Œè·å–æŠ¥å‘Š
curl http://localhost:8000/api/report/$TASK_ID \
  -H "Authorization: Bearer {token}"
```

**éªŒæ”¶ç‚¹**:
- [ ] ä»»åŠ¡åˆ›å»ºæˆåŠŸï¼Œè¿”å› task_id
- [ ] SSE è¿æ¥æˆåŠŸï¼Œæ”¶åˆ° connected äº‹ä»¶
- [ ] æ”¶åˆ°å¤šä¸ª progress äº‹ä»¶ï¼ˆè‡³å°‘4ä¸ªï¼‰
- [ ] æ”¶åˆ° completed äº‹ä»¶
- [ ] GET /api/status è¿”å› completed çŠ¶æ€
- [ ] GET /api/report è¿”å›å®Œæ•´æŠ¥å‘Šæ•°æ®

---

### Step 4: Lead ç¡®è®¤éªŒæ”¶ï¼ˆ18:15-18:30ï¼‰

**Lead æ£€æŸ¥æ¸…å•**:
- [ ] âœ… ä»£ç è´¨é‡ï¼šmypy + pytest å…¨éƒ¨é€šè¿‡
- [ ] âœ… åŠŸèƒ½å®Œæ•´ï¼š4ä¸ªAPIç«¯ç‚¹å…¨éƒ¨å¯ç”¨
- [ ] âœ… é›†æˆæµ‹è¯•ï¼šç«¯åˆ°ç«¯æµç¨‹é€šè¿‡
- [ ] âœ… æ–‡æ¡£å®Œæ•´ï¼šWORKER_OPS.md å­˜åœ¨ä¸”å†…å®¹å®Œæ•´
- [ ] âœ… æ— é˜»å¡é—®é¢˜ï¼šDay 5 å¯ä»¥æ­£å¸¸å¯åŠ¨

**éªŒæ”¶ç»“è®º**:
- âœ… **é€šè¿‡** - Day 4 æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼Œå¯ä»¥è¿›å…¥ Day 5
- âŒ **ä¸é€šè¿‡** - åˆ—å‡ºæœªå®Œæˆé¡¹ï¼Œåˆ†é…ä¿®å¤ä»»åŠ¡ï¼Œ1å°æ—¶å†…ä¿®å¤åé‡æ–°éªŒæ”¶

---

## ğŸ“ˆ Day 4 æˆåŠŸæ ‡å¿—

### æŠ€æœ¯æŒ‡æ ‡
- âœ… API ç«¯ç‚¹æ•°é‡ï¼š4/4ï¼ˆ100%ï¼‰
- âœ… mypy --strict: 0 errors
- âœ… pytest é€šè¿‡ç‡: 100%
- âœ… API å“åº”æ—¶é—´: <200ms
- âœ… SSE è¿æ¥æˆåŠŸç‡: 100%

### ä¸šåŠ¡æŒ‡æ ‡
- âœ… ä»»åŠ¡çŠ¶æ€ç®¡ç†ï¼šå®æ—¶æ›´æ–° âœ…
- âœ… ä»»åŠ¡è¿›åº¦æ¨é€ï¼šè‡³å°‘4ä¸ªè¿›åº¦ç‚¹ âœ…
- âœ… ç«¯åˆ°ç«¯æµç¨‹ï¼šå®Œå…¨æ‰“é€š âœ…

### å›¢é˜ŸæŒ‡æ ‡
- âœ… Backend A æŒ‰æ—¶å®Œæˆ
- âœ… Backend B æŒ‰æ—¶å®Œæˆ
- âœ… Frontend å­¦ä¹ å’Œå‡†å¤‡å®Œæˆ
- âœ… å›¢é˜Ÿåä½œé¡ºç•…ï¼Œæ— é˜»å¡

---

## ğŸ¯ Day 4 å®Œæˆåçš„çŠ¶æ€

### API å±‚çŠ¶æ€
```
âœ… POST /api/analyze          - Day 3 å®Œæˆ
âœ… GET /api/status/{task_id}  - Day 4 å®Œæˆ
âœ… GET /api/analyze/stream/{task_id} - Day 4 å®Œæˆ
âœ… GET /api/report/{task_id}  - Day 4 å®Œæˆ

â¡ï¸ API å±‚ 100% å®Œæˆï¼Œç¬¦åˆ PRD-02
```

### ä»»åŠ¡ç³»ç»ŸçŠ¶æ€
```
âœ… Celery åŸºç¡€é…ç½®          - Day 3 å®Œæˆ
âœ… Worker å¯åŠ¨è„šæœ¬          - Day 3 å®Œæˆ
âœ… ä»»åŠ¡çŠ¶æ€ç®¡ç†            - Day 4 å®Œæˆ
âœ… ä»»åŠ¡è¿›åº¦æ¨é€            - Day 4 å®Œæˆ

â¡ï¸ ä»»åŠ¡ç³»ç»Ÿ 100% å®Œæˆï¼Œç¬¦åˆ PRD-04
```

### ä¸º Day 5 åšå¥½å‡†å¤‡
```
âœ… 4ä¸ªAPIç«¯ç‚¹å…¨éƒ¨å¯ç”¨
âœ… å‰ç«¯å¯ä»¥å¼€å§‹è°ƒç”¨çœŸå®API
âœ… Day 5 æ—©ä¸Š 9:00 API äº¤æ¥ä¼šå‡†å¤‡å®Œæˆ
âœ… å‰ç«¯å¼€å‘æ— é˜»å¡

â¡ï¸ Day 5 å‰ç«¯å¯ä»¥å…¨é€Ÿå¼€å‘ ğŸš€
```

---

## ğŸ“ éªŒæ”¶è®°å½•è¡¨

**éªŒæ”¶æ—¥æœŸ**: 2025-10-10
**éªŒæ”¶æ—¶é—´**: 18:00-18:30
**éªŒæ”¶äºº**: Lead

### Backend A éªŒæ”¶è®°å½•

| éªŒæ”¶é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|------|------|
| GET /api/status/{task_id} | [ ] âœ… [ ] âŒ | |
| GET /api/analyze/stream/{task_id} | [ ] âœ… [ ] âŒ | |
| GET /api/report/{task_id} | [ ] âœ… [ ] âŒ | |
| æµ‹è¯•é€šè¿‡ï¼ˆtest_stream.pyï¼‰ | [ ] âœ… [ ] âŒ | |
| æµ‹è¯•é€šè¿‡ï¼ˆtest_reports.pyï¼‰ | [ ] âœ… [ ] âŒ | |
| mypy --strict 0 errors | [ ] âœ… [ ] âŒ | |

**Backend A éªŒæ”¶ç»“è®º**: [ ] âœ… é€šè¿‡ [ ] âŒ ä¸é€šè¿‡

---

### Backend B éªŒæ”¶è®°å½•

| éªŒæ”¶é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|------|------|
| ä»»åŠ¡çŠ¶æ€ç®¡ç†ï¼ˆRedisï¼‰ | [ ] âœ… [ ] âŒ | |
| ä»»åŠ¡è¿›åº¦æ¨é€ | [ ] âœ… [ ] âŒ | |
| æµ‹è¯•é€šè¿‡ï¼ˆtest_task_system.pyï¼‰ | [ ] âœ… [ ] âŒ | |
| Worker æ–‡æ¡£å®Œæ•´ | [ ] âœ… [ ] âŒ | |
| mypy --strict 0 errors | [ ] âœ… [ ] âŒ | |

**Backend B éªŒæ”¶ç»“è®º**: [ ] âœ… é€šè¿‡ [ ] âŒ ä¸é€šè¿‡

---

### Frontend éªŒæ”¶è®°å½•

| éªŒæ”¶é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|------|------|
| å­¦ä¹  SSE å®¢æˆ·ç«¯å®Œæˆ | [ ] âœ… [ ] âŒ | |
| é¡¹ç›®ç»“æ„ä¼˜åŒ–å®Œæˆ | [ ] âœ… [ ] âŒ | |
| ç±»å‹å®šä¹‰éªŒè¯é€šè¿‡ | [ ] âœ… [ ] âŒ | |
| API å¯¹æ¥ç¯å¢ƒå‡†å¤‡å®Œæˆ | [ ] âœ… [ ] âŒ | |

**Frontend éªŒæ”¶ç»“è®º**: [ ] âœ… é€šè¿‡ [ ] âŒ ä¸é€šè¿‡

---

### é›†æˆéªŒæ”¶è®°å½•

| éªŒæ”¶é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|------|------|
| ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•é€šè¿‡ | [ ] âœ… [ ] âŒ | |
| SSE äº‹ä»¶æ¨é€æ­£å¸¸ | [ ] âœ… [ ] âŒ | |
| ä»»åŠ¡çŠ¶æ€åŒæ­¥æ­£ç¡® | [ ] âœ… [ ] âŒ | |

---

### Day 4 æœ€ç»ˆéªŒæ”¶ç»“è®º

**çŠ¶æ€**: [ ] âœ… é€šè¿‡ [ ] âŒ ä¸é€šè¿‡

**ç­¾å­—**:
- Lead: ________________  æ—¥æœŸ: ________
- Backend A: ________________  æ—¥æœŸ: ________
- Backend B: ________________  æ—¥æœŸ: ________
- Frontend: ________________  æ—¥æœŸ: ________

---

## ğŸ“ Day 4 è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼ŒæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§å¤„ç†ï¼š

### ä¼˜å…ˆçº§ P0ï¼ˆé˜»å¡å¼€å‘ï¼‰
- ç«‹å³ @Lead
- æ‹‰ä¸‰æ–¹ç´§æ€¥ä¼šè®®
- 30åˆ†é’Ÿå†…å¿…é¡»è§£å†³

### ä¼˜å…ˆçº§ P1ï¼ˆå½±å“è¿›åº¦ï¼‰
- åœ¨åä½œèŠ‚ç‚¹ï¼ˆ10:00, 16:00ï¼‰æå‡º
- å½“å¤©å¿…é¡»è§£å†³

### ä¼˜å…ˆçº§ P2ï¼ˆä¸ç´§æ€¥ï¼‰
- è®°å½•åˆ°æ–‡æ¡£
- Day 5 æ’æœŸå¤„ç†

---

**Day 4 åŠ æ²¹ï¼Let's ship it! ğŸš€**

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-10-10 16:45
**ç»´æŠ¤äºº**: Lead
**æ–‡æ¡£è·¯å¾„**: `/Users/hujia/Desktop/RedditSignalScanner/DAY4-TASK-ASSIGNMENT.md`
