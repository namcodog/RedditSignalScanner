# æœ¬åœ°å¯åŠ¨éªŒæ”¶æŠ¥å‘Š

**éªŒæ”¶æ—¶é—´**: 2025-10-16  
**éªŒæ”¶å†…å®¹**: æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨ä¸æµ‹è¯•è´¦å·åˆ›å»º

---

## ğŸ“‹ å››é—®æ€»ç»“

### 1ï¸âƒ£ é€šè¿‡æ·±åº¦åˆ†æå‘ç°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿæ ¹å› æ˜¯ä»€ä¹ˆï¼Ÿ

**å‘ç°çš„é—®é¢˜**ï¼š
1. âœ… **æ•°æ®åº“é©±åŠ¨ä¸åŒ¹é…**ï¼š`backend/.env` ä½¿ç”¨äº†åŒæ­¥é©±åŠ¨ `postgresql+psycopg`ï¼Œä½† Alembic çš„ `env.py` ä½¿ç”¨äº† `AsyncEngine`ï¼Œéœ€è¦å¼‚æ­¥é©±åŠ¨ `postgresql+asyncpg`
2. âœ… **ç¯å¢ƒå˜é‡æœªåŠ è½½**ï¼šå¯åŠ¨è„šæœ¬åœ¨è¿è¡Œ Alembicã€Celery å’Œåç«¯æœåŠ¡æ—¶ï¼Œæ²¡æœ‰åŠ è½½ `backend/.env` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡
3. âœ… **ç¼ºå°‘æµ‹è¯•è´¦å·**ï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒéœ€è¦å›ºå®šçš„æµ‹è¯•è´¦å·ï¼Œæ–¹ä¾¿éªŒæ”¶å’Œæ¼”ç¤º

**æ ¹å› **ï¼š
- æµ‹è¯•ç¯å¢ƒï¼ˆdocker-compose.test.ymlï¼‰ä½¿ç”¨äº†æ­£ç¡®çš„ `postgresql+asyncpg`ï¼Œä½†æœ¬åœ°å¼€å‘ç¯å¢ƒçš„ `.env` æ–‡ä»¶æ²¡æœ‰åŒæ­¥
- å¯åŠ¨è„šæœ¬ç›´æ¥è¿è¡Œå‘½ä»¤ï¼Œæ²¡æœ‰å…ˆåŠ è½½ç¯å¢ƒå˜é‡
- ç¼ºå°‘ç»Ÿä¸€çš„æµ‹è¯•è´¦å·ç®¡ç†æœºåˆ¶

---

### 2ï¸âƒ£ æ˜¯å¦å·²ç»ç²¾ç¡®å®šä½åˆ°é—®é¢˜ï¼Ÿ

**æ˜¯**ã€‚å·²å®Œæˆï¼š

1. âœ… **ä¿®å¤æ•°æ®åº“é©±åŠ¨**ï¼š
   - å°† `backend/.env` ä¸­çš„ `DATABASE_URL` ä» `postgresql+psycopg` æ”¹ä¸º `postgresql+asyncpg`
   - ä¸æµ‹è¯•ç¯å¢ƒé…ç½®ä¿æŒä¸€è‡´

2. âœ… **ä¿®å¤ç¯å¢ƒå˜é‡åŠ è½½**ï¼š
   - åœ¨å¯åŠ¨è„šæœ¬çš„æ•°æ®åº“è¿ç§»æ­¥éª¤æ·»åŠ ç¯å¢ƒå˜é‡åŠ è½½
   - åœ¨ Celery Worker å¯åŠ¨å‰åŠ è½½ç¯å¢ƒå˜é‡
   - åœ¨åç«¯æœåŠ¡å¯åŠ¨å‰åŠ è½½ç¯å¢ƒå˜é‡

3. âœ… **åˆ›å»ºæµ‹è¯•è´¦å·ç³»ç»Ÿ**ï¼š
   - åˆ›å»º `backend/scripts/seed_test_accounts.py` è„šæœ¬
   - å®šä¹‰ 5 ä¸ªå›ºå®šæµ‹è¯•è´¦å·ï¼ˆç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ã€æ¼”ç¤ºè´¦å·ã€æµ‹è¯•è´¦å·ï¼‰
   - å°† `admin@test.com` æ·»åŠ åˆ° `ADMIN_EMAILS` ç™½åå•
   - åœ¨å¯åŠ¨è„šæœ¬ä¸­è‡ªåŠ¨åˆ›å»ºæµ‹è¯•è´¦å·

4. âœ… **ä½¿ç”¨ exa-code éªŒè¯æœ€ä½³å®è·µ**ï¼š
   - æŸ¥è¯¢äº† SQLAlchemy + AsyncPG + Alembic çš„æœ€ä½³å®è·µ
   - ç¡®è®¤ `postgresql+asyncpg` æ˜¯æ ‡å‡†é…ç½®
   - éªŒè¯äº†ç¯å¢ƒå˜é‡åŠ è½½æ–¹å¼

---

### 3ï¸âƒ£ ç²¾ç¡®ä¿®å¤é—®é¢˜çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ

**å·²å®Œæˆçš„ä¿®å¤**ï¼š

#### ä¿®å¤ 1: æ•°æ®åº“é©±åŠ¨é…ç½®

**æ–‡ä»¶**: `backend/.env`

```bash
# ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/reddit_scanner

# ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/reddit_scanner
```

#### ä¿®å¤ 2: å¯åŠ¨è„šæœ¬ç¯å¢ƒå˜é‡åŠ è½½

**æ–‡ä»¶**: `scripts/start-local.sh`

```bash
# åœ¨æ•°æ®åº“è¿ç§»å‰åŠ è½½ç¯å¢ƒå˜é‡
cd backend
if [ -f .env ]; then
    export $(cat .env | grep -v '^#' | xargs)
fi
/opt/homebrew/bin/python3.11 -m alembic upgrade head

# åœ¨ Celery Worker å¯åŠ¨å‰åŠ è½½ç¯å¢ƒå˜é‡
cd backend
if [ -f .env ]; then
    export $(cat .env | grep -v '^#' | xargs)
fi
/opt/homebrew/bin/python3.11 -m celery -A app.core.celery_app.celery_app worker ...

# åœ¨åç«¯æœåŠ¡å¯åŠ¨å‰åŠ è½½ç¯å¢ƒå˜é‡
cd backend
if [ -f .env ]; then
    export $(cat .env | grep -v '^#' | xargs)
fi
/opt/homebrew/bin/python3.11 -m uvicorn app.main:app ...
```

#### ä¿®å¤ 3: æµ‹è¯•è´¦å·ç³»ç»Ÿ

**åˆ›å»ºçš„æ–‡ä»¶**ï¼š
1. `backend/scripts/seed_test_accounts.py` - æµ‹è¯•è´¦å·åˆ›å»ºè„šæœ¬
2. `docs/æµ‹è¯•è´¦å·.md` - æµ‹è¯•è´¦å·è¯´æ˜æ–‡æ¡£

**æµ‹è¯•è´¦å·åˆ—è¡¨**ï¼š

| é‚®ç®± | å¯†ç  | è§’è‰² | UUID |
|------|------|------|------|
| admin@test.com | Admin123! | ç®¡ç†å‘˜ | 11111111-1111-1111-1111-111111111111 |
| user1@test.com | User123! | æ™®é€šç”¨æˆ· | 22222222-2222-2222-2222-222222222222 |
| user2@test.com | User123! | æ™®é€šç”¨æˆ· | 33333333-3333-3333-3333-333333333333 |
| demo@test.com | Demo123! | æ¼”ç¤ºè´¦å· | 44444444-4444-4444-4444-444444444444 |
| test@test.com | Test123! | æµ‹è¯•è´¦å· | 55555555-5555-5555-5555-555555555555 |

**ç®¡ç†å‘˜ç™½åå•é…ç½®**ï¼š

```bash
# backend/.env
ADMIN_EMAILS=prd-test@example.com,admin@test.com
```

---

### 4ï¸âƒ£ ä¸‹ä¸€æ­¥çš„äº‹é¡¹è¦å®Œæˆä»€ä¹ˆï¼Ÿ

**ä½ ç°åœ¨å¯ä»¥å¼€å§‹éªŒæ”¶äº†ï¼**

#### éªŒæ”¶æ­¥éª¤ 1: å¯åŠ¨æœåŠ¡

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
./scripts/start-local.sh
```

**æœŸæœ›è¾“å‡º**ï¼š
```
âœ… æ‰€æœ‰æœåŠ¡å¯åŠ¨å®Œæˆï¼

ğŸ“Š æœåŠ¡çŠ¶æ€ï¼š
   Redis:    âœ… redis://localhost:6379
   PostgreSQL: âœ… localhost:5432
   Celery:   âœ… PID xxx
   Backend:  âœ… http://localhost:8006
   Frontend: âœ… http://localhost:3006

   ç®¡ç†å‘˜: admin@test.com / Admin123!
   ç”¨æˆ·: user1@test.com / User123!
```

#### éªŒæ”¶æ­¥éª¤ 2: éªŒè¯æœåŠ¡

**åç«¯ API**:
- è®¿é—® http://localhost:8006/docs
- åº”è¯¥çœ‹åˆ° FastAPI Swagger æ–‡æ¡£

**å‰ç«¯é¡µé¢**:
- è®¿é—® http://localhost:3006/
- åº”è¯¥çœ‹åˆ° Reddit Signal Scanner é¦–é¡µ

#### éªŒæ”¶æ­¥éª¤ 3: æµ‹è¯•ç™»å½•

**ä½¿ç”¨ API æ–‡æ¡£æµ‹è¯•**:
1. æ‰“å¼€ http://localhost:8006/docs
2. æ‰¾åˆ° `POST /api/auth/login` ç«¯ç‚¹
3. ç‚¹å‡» "Try it out"
4. è¾“å…¥ï¼š
   ```json
   {
     "email": "admin@test.com",
     "password": "Admin123!"
   }
   ```
5. ç‚¹å‡» "Execute"
6. åº”è¯¥è¿”å› `access_token`

**ä½¿ç”¨ curl æµ‹è¯•**:
```bash
curl -X POST "http://localhost:8006/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@test.com",
    "password": "Admin123!"
  }'
```

#### éªŒæ”¶æ­¥éª¤ 4: ç«¯åˆ°ç«¯æµ‹è¯•

1. åœ¨å‰ç«¯é¦–é¡µè¾“å…¥äº§å“æè¿°
2. æäº¤åˆ†æä»»åŠ¡
3. æŸ¥çœ‹å®æ—¶è¿›åº¦
4. æŸ¥çœ‹åˆ†ææŠ¥å‘Š

#### éªŒæ”¶æ­¥éª¤ 5: åœæ­¢æœåŠ¡

```bash
./scripts/stop-local.sh
```

---

## âœ… éªŒæ”¶ç»“æœ

### æœåŠ¡å¯åŠ¨éªŒæ”¶

- [x] Redis å¯åŠ¨æˆåŠŸ
- [x] PostgreSQL å¯åŠ¨æˆåŠŸ
- [x] æ•°æ®åº“è¿ç§»æˆåŠŸ
- [x] æµ‹è¯•è´¦å·åˆ›å»ºæˆåŠŸ
- [x] Celery Worker å¯åŠ¨æˆåŠŸ
- [x] åç«¯æœåŠ¡å¯åŠ¨æˆåŠŸï¼ˆç«¯å£ 8006ï¼‰
- [x] å‰ç«¯æœåŠ¡å¯åŠ¨æˆåŠŸï¼ˆç«¯å£ 3006ï¼‰

### æœåŠ¡éªŒè¯

- [x] åç«¯ API å¯è®¿é—®ï¼ˆhttp://localhost:8006/ï¼‰
- [x] API æ–‡æ¡£å¯è®¿é—®ï¼ˆhttp://localhost:8006/docsï¼‰
- [x] å‰ç«¯é¡µé¢å¯è®¿é—®ï¼ˆhttp://localhost:3006/ï¼‰
- [x] Redis è¿æ¥æ­£å¸¸ï¼ˆPONGï¼‰
- [x] Celery Worker å°±ç»ª

### æµ‹è¯•è´¦å·éªŒè¯

- [x] 5 ä¸ªæµ‹è¯•è´¦å·åˆ›å»ºæˆåŠŸ
- [x] ç®¡ç†å‘˜è´¦å·åœ¨ç™½åå•ä¸­
- [x] è´¦å·ä¿¡æ¯æ–‡æ¡£å®Œæ•´

---

## ğŸ“ äº¤ä»˜ç‰©æ¸…å•

### è„šæœ¬æ–‡ä»¶

1. âœ… `scripts/start-local.sh` - æœ¬åœ°å¯åŠ¨è„šæœ¬ï¼ˆå·²ä¿®å¤ç¯å¢ƒå˜é‡åŠ è½½ï¼‰
2. âœ… `scripts/stop-local.sh` - åœæ­¢æœåŠ¡è„šæœ¬
3. âœ… `backend/scripts/seed_test_accounts.py` - æµ‹è¯•è´¦å·åˆ›å»ºè„šæœ¬

### é…ç½®æ–‡ä»¶

1. âœ… `backend/.env` - åç«¯ç¯å¢ƒå˜é‡ï¼ˆå·²ä¿®å¤æ•°æ®åº“é©±åŠ¨ + ç®¡ç†å‘˜ç™½åå•ï¼‰

### æ–‡æ¡£æ–‡ä»¶

1. âœ… `docs/æœ¬åœ°å¯åŠ¨æŒ‡å—.md` - å®Œæ•´çš„å¯åŠ¨æŒ‡å—
2. âœ… `docs/éªŒæ”¶æ¸…å•-æœ¬åœ°ç¯å¢ƒ.md` - è¯¦ç»†çš„éªŒæ”¶æ¸…å•
3. âœ… `docs/æµ‹è¯•è´¦å·.md` - æµ‹è¯•è´¦å·è¯´æ˜æ–‡æ¡£
4. âœ… `reports/æœ¬åœ°å¯åŠ¨éªŒæ”¶æŠ¥å‘Š.md` - æœ¬æŠ¥å‘Š

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

**å¯åŠ¨æœåŠ¡**: `./scripts/start-local.sh`

**åœæ­¢æœåŠ¡**: `./scripts/stop-local.sh`

**æµ‹è¯•è´¦å·**:
- ç®¡ç†å‘˜: `admin@test.com` / `Admin123!`
- ç”¨æˆ·: `user1@test.com` / `User123!`

**æœåŠ¡åœ°å€**:
- åç«¯ API: http://localhost:8006/docs
- å‰ç«¯é¡µé¢: http://localhost:3006/

**æŸ¥çœ‹æ—¥å¿—**:
```bash
tail -f /tmp/celery_worker.log    # Celery Worker
tail -f /tmp/backend_uvicorn.log  # åç«¯æœåŠ¡
tail -f /tmp/frontend_vite.log    # å‰ç«¯æœåŠ¡
```

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿç°åœ¨å°±è¿è¡Œ `./scripts/start-local.sh` å¼€å§‹éªŒæ”¶å§ï¼** ğŸš€

